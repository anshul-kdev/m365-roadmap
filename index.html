<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M365 Consultant's Roadmap v5</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f1f5f9;
            --card-bg-color: #ffffff;
            --text-color: #1e293b;
            --text-muted-color: #475569;
            --heading-color: #0f172a;
            --border-color: #e2e8f0;
            --primary-color: #0ea5e9;
            --primary-hover-color: #0284c7;
            --highlight-bg-color: #f8fafc;
            --accent-bg-color: #f0f9ff;
            --accent-border-color: #7dd3fc;
            --accent-text-color: #0c4a6e;
            --success-bg-color: #f0fdf4;
            --success-border-color: #4ade80;
            --success-text-color: #15803d;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .dark {
            --bg-color: #020617;
            --card-bg-color: #0f172a;
            --text-color: #cbd5e1;
            --text-muted-color: #94a3b8;
            --heading-color: #f8fafc;
            --border-color: #334155;
            --primary-color: #38bdf8;
            --primary-hover-color: #0ea5e9;
            --highlight-bg-color: #1e293b;
            --accent-bg-color: #1e3a8a;
            --accent-border-color: #3b82f6;
            --accent-text-color: #bfdbfe;
            --success-bg-color: #166534;
            --success-border-color: #4ade80;
            --success-text-color: #dcfce7;
        }
        html { 
            scroll-behavior: smooth;
            scroll-padding-top: 2rem;
        }
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-color); 
            transition: background-color 0.3s, color 0.3s;
            line-height: 1.6;
        }
        main { 
            scroll-behavior: smooth;
            padding: 1.5rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        .sidebar-link.active { 
            background-color: var(--primary-color); 
            color: white; 
            box-shadow: 0 0 15px var(--primary-color);
            transform: translateX(0.5rem);
        }
        .week-card { 
            transition: all 0.3s ease;
            border-radius: 0.75rem;
            border: 1px solid var(--border-color);
            background-color: var(--card-bg-color);
            box-shadow: var(--shadow-sm);
        }
        .week-card:hover { 
            transform: translateY(-5px); 
            box-shadow: var(--shadow-lg);
        }
        .tab-button {
            position: relative;
            transition: all 0.3s ease;
        }
        .tab-button::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary-color);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        .tab-button.active::after {
            transform: scaleX(1);
        }
        .lab-step {
            transition: all 0.3s ease;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        .lab-step:hover {
            box-shadow: var(--shadow-md);
        }
        .lab-step-header {
            padding: 1.25rem;
            background-color: var(--highlight-bg-color);
            border-bottom: 1px solid var(--border-color);
        }
        .lab-step-content {
            background-color: var(--card-bg-color);
            padding: 1.5rem;
        }
        .progress-bar-container {
            height: 0.5rem;
            background-color: var(--highlight-bg-color);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
        }
        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            transition: width 0.5s ease;
            border-radius: 1rem;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .concept-card {
            border-radius: 1rem;
            padding: 1.5rem;
            background-color: var(--highlight-bg-color);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }
        .concept-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        .concept-title {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 0.75rem;
        }
        .source-link {
            display: inline-flex;
            align-items: center;
            color: var(--primary-color);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            background-color: var(--accent-bg-color);
            transition: all 0.3s ease;
            margin-top: 1rem;
        }
        .source-link:hover {
            background-color: var(--primary-color);
            color: white;
        }
       /* Task Completion Styles */
       .todo-item.is-checked .lab-step-header { 
           background-color: var(--success-bg-color) !important;
           border-color: var(--success-border-color) !important;
       }
       .todo-item.is-checked .lab-step-header .step-title { 
           text-decoration: line-through !important;
           color: var(--success-text-color) !important;
       }
       .todo-item.is-checked .lab-step-header .checkmark { 
           background-color: var(--success-text-color) !important;
           border-color: var(--success-border-color) !important;
       }
       
       /* Lab Step Animations */
       .lab-step.open .accordion-icon { 
           transform: rotate(180deg);
           transition: transform 0.3s ease;
       }
       .lab-step.open .lab-step-content { 
           max-height: 5000px !important;
           transition: max-height 0.8s cubic-bezier(0.4, 0, 0.2, 1);
       }
       .lab-step-content { 
           max-height: 0;
           overflow: hidden;
           transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
       }
       
       /* Interactive Elements */
       .lab-step:hover .lab-step-header { 
           background-color: var(--accent-bg-color);
           transform: translateY(-1px);
           transition: all 0.3s ease;
       }
       .expand-btn { 
           transition: all 0.2s ease;
       }
       .expand-btn:hover { 
           background-color: var(--accent-bg-color) !important;
           transform: scale(1.1);
       }
       
       /* Progress Indicators */
       .learning-path-item.completed .learning-path-dot { 
           background-color: var(--success-border-color);
           box-shadow: 0 0 0 4px var(--success-bg-color);
       }
       .learning-path-item.completed .learning-path-line { 
           background-color: var(--success-border-color);
           transform: scaleX(1);
           transition: transform 0.6s ease;
       }
       
       /* Content Transitions */
       .content-fade-enter { 
           opacity: 0;
           transform: translateY(20px);
       }
       .content-fade-enter-active { 
           opacity: 1;
           transform: translateY(0);
           transition: opacity 300ms cubic-bezier(0.4, 0, 0.2, 1),
                      transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
       }
        #sidebar { 
            transition: width 0.3s ease-in-out, padding 0.3s ease-in-out; 
            box-shadow: var(--shadow-sm);
            z-index: 40;
        }
        #sidebar.collapsed { 
            width: 0; 
            padding: 0; 
            overflow: hidden;
            box-shadow: none;
        }
        #sidebar.collapsed > * { display: none; }
        
        @media (max-width: 768px) {
            #sidebar {
                position: fixed;
                height: 100vh;
                left: 0;
                top: 0;
            }
            #sidebar.collapsed {
                transform: translateX(-100%);
            }
            .main-content {
                margin-left: 0 !important;
            }
        }
    </style>
</head>
<body class="antialiased">
    <div class="flex h-screen">
        <aside id="sidebar" class="w-80 flex-shrink-0 p-6 flex flex-col overflow-y-auto backdrop-blur-sm bg-opacity-95" style="background-color: var(--card-bg-color); border-right: 1px solid var(--border-color);">
            <div class="flex items-center justify-between mb-6">
                <h1 class="text-2xl font-bold" style="color: var(--primary-color);">M365 Roadmap</h1>
                <div class="flex items-center space-x-2">
                    <span class="text-sm font-medium px-2 py-1 rounded-full" style="background-color: var(--accent-bg-color); color: var(--primary-color);">
                        <span class="completion-percentage">0</span>% Complete
                    </span>
                </div>
            </div>
            <div class="relative w-full mb-6">
                <input type="text" id="search-input" 
                    placeholder="Search topics..." 
                    class="w-full pl-10 pr-4 py-3 border rounded-lg text-sm transition-all duration-300 focus:ring-2 focus:ring-opacity-50" 
                    style="border-color: var(--border-color); background-color: var(--bg-color); box-shadow: var(--shadow-sm);">
                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-lg" style="color: var(--text-muted-color);">🔍</span>
            </div>
            <div id="progress-tracker" class="mb-6">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-sm font-semibold" style="color: var(--text-muted-color);">Overall Progress</h3>
                    <div class="text-sm" style="color: var(--primary-color);">
                        <span id="completedTasks">0</span>/<span id="totalTasks">0</span> Tasks
                    </div>
                </div>
                <div class="relative w-full h-2 rounded-full overflow-hidden" style="background-color: var(--highlight-bg-color);">
                    <div id="progressBar" 
                        class="h-full rounded-full transition-all duration-700 ease-out transform origin-left" 
                        style="width: 0%; background-color: var(--primary-color); box-shadow: 0 0 8px var(--primary-color);">
                    </div>
                </div>
            </div>
            
            <!-- Study Timer -->
            <div id="study-timer" class="mb-6 p-4 rounded-lg" style="background-color: var(--highlight-bg-color); border: 1px solid var(--border-color);">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-sm font-semibold" style="color: var(--text-muted-color);">Study Timer</h3>
                    <div class="flex items-center text-xs" style="color: var(--text-muted-color);">
                        <span id="timer-mode" class="px-2 py-1 rounded-full" style="background-color: var(--accent-bg-color); color: var(--primary-color);">Focus Time</span>
                    </div>
                </div>
                <div class="text-center text-3xl font-bold mb-3" id="timer-display" style="color: var(--primary-color); font-feature-settings: 'tnum';">25:00</div>
                <div class="flex justify-center gap-2">
                    <button id="timer-toggle" class="px-4 py-2 rounded-lg text-white font-medium transition transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-opacity-50" style="background-color: var(--primary-color); box-shadow: var(--shadow-sm);">Start Focus</button>
                    <button id="timer-reset" class="px-4 py-2 rounded-lg font-medium transition hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-opacity-50" style="background-color: var(--highlight-bg-color); color: var(--text-color); border: 1px solid var(--border-color);">Reset</button>
                </div>
            </div>
            <nav id="weeks-list" class="flex-grow space-y-3">
                </nav>
            <div class="mt-6 p-4 rounded-lg" style="background-color: var(--highlight-bg-color); border: 1px solid var(--border-color);">
                <label for="darkModeToggle" class="flex items-center justify-between cursor-pointer">
                    <div class="flex items-center">
                        <span class="mr-3">🌓</span>
                        <span class="font-medium">Dark Mode</span>
                    </div>
                    <div class="relative">
                        <input type="checkbox" id="darkModeToggle" class="sr-only">
                        <div class="block w-14 h-8 rounded-full transition" style="background-color: var(--border-color);"></div>
                        <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform duration-200 transform" style="box-shadow: var(--shadow-sm);"></div>
                    </div>
                </label>
            </div>
        </aside>

        <main class="flex-1 p-4 md:p-8 overflow-y-auto relative main-content">
            <div class="sticky top-0 z-40 flex items-center justify-between mb-6 py-2 -mt-2" style="background-color: var(--bg-color);">
                <button id="sidebar-toggle" class="p-2 rounded-lg hover:bg-opacity-90 transition-all" style="background-color: var(--card-bg-color); box-shadow: var(--shadow-sm);">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                    </svg>
                </button>
                <div class="flex items-center space-x-4">
                    <a href="https://github.com/yourusername/m365-roadmap" target="_blank" 
                        class="inline-flex items-center px-4 py-2 rounded-lg font-medium transition-all" 
                        style="background-color: var(--card-bg-color); color: var(--text-color); border: 1px solid var(--border-color); box-shadow: var(--shadow-sm);">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
                        </svg>
                        GitHub
                    </a>
                </div>
            </div>
            <div id="content-display" class="relative"
                </div>
        </main>
    </div>

     <div id="screenshotModal" class="fixed inset-0 bg-black bg-opacity-75 backdrop-blur-sm flex items-center justify-center p-4 opacity-0 pointer-events-none z-50 transition-opacity duration-300">
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-4xl w-full p-6 transform scale-95 transition-transform duration-300" style="background-color: var(--card-bg-color);">
            <div class="flex items-center justify-between mb-4">
                <h3 id="screenshotTitle" class="text-xl font-bold" style="color: var(--heading-color);"></h3>
                <button id="closeScreenshotModalBtn" class="p-2 rounded-lg hover:bg-opacity-90 transition-colors" style="background-color: var(--highlight-bg-color);">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <img id="screenshotImage" src="" alt="Screenshot" class="w-full h-auto rounded-lg shadow-md" style="border: 1px solid var(--border-color);">
        </div>
    </div>
    <script>
        const weeklyData = [
            { week: 1, part: 1, title: "Microsoft Entra ID", theme: "Identity Foundations", certs: ['SC-900'] },
            { week: 2, part: 1, title: "Conditional Access", theme: "Identity Security", certs: ['SC-300'] },
            { week: 3, part: 1, title: "Privileged Identity Management (PIM)", theme: "Privileged Access", certs: ['SC-300', 'AZ-500'] },
            { week: 4, part: 2, title: "Defender for Office 365", theme: "Threat Protection", certs: ['MS-102'] },
            { week: 5, part: 2, title: "Purview Data Loss Prevention (DLP)", theme: "Information Governance", certs: ['SC-400'] },
            { week: 6, part: 2, title: "Purview eDiscovery & Sentinel", theme: "Security Operations", certs: ['SC-200', 'AZ-500'] },
            { week: 7, part: 3, title: "Intune & Windows Autopilot", theme: "Modern Deployment", certs: ['MD-102'] },
            { week: 8, part: 3, title: "Intune Compliance & App Protection", theme: "Endpoint Security", certs: ['MD-102'] },
            { week: 9, part: 3, title: "Intune Suite Features", theme: "Advanced Endpoint", certs: ['MD-102'] },
            { week: 10, part: 4, title: "Power Platform", theme: "Business Automation", certs: ['PL-900'] },
            { week: 11, part: 4, title: "Microsoft Graph & SPFx", theme: "Programmatic Access", certs: ['MS-600'] },
            { week: 12, part: 4, title: "Teams App Publishing & Capstone", theme: "Platform Extensibility", certs: ['MS-600'] },
        ];
        // Achievement system
        const achievements = {
            weekCompleter: { title: "Week Master", description: "Complete all tasks in a week", icon: "🌟" },
            speedLearner: { title: "Speed Learner", description: "Complete 3 tasks in one day", icon: "⚡" },
            perfectStudent: { title: "Perfect Student", description: "Add notes for every completed task", icon: "📝" }
        };
        
        // Study timer state
        let studyTimer = {
            duration: 25 * 60, // 25 minutes in seconds
            breakTime: 5 * 60, // 5 minutes in seconds
            isRunning: false,
            timeLeft: 25 * 60,
            isBreak: false,
            interval: null
        };

        const contentData = {
            1: { 
                feature: { title: "Microsoft Entra ID", text: "The cloud-based identity and access management (IAM) service, acting as the 'front door' to all cloud resources. Your E5 sandbox includes the P2 version, unlocking advanced security and governance features." }, 
                objectives: ["Understand the core concepts of cloud identity.", "Configure tenant-wide settings and branding.", "Perform basic user and group management."], 
                concepts: [
                    { title: "Cloud vs. On-Premises Identity", details: "On-premises identity relies on local servers like Active Directory, managed within an organization's private network. Cloud identity, like Entra ID, is managed by a third-party provider (Microsoft) and is accessible over the internet, enabling seamless access to cloud services and modern authentication methods." },
                    { title: "Users, Groups, and Roles", details: "Users are the individual identity accounts for people accessing resources. Groups are collections of users, devices, or other groups, used to simplify permissions management. Roles (like Global Administrator) are sets of permissions that can be assigned to users to grant them specific administrative capabilities." },
                    { title: "Tenant Structure and Subscriptions", details: "A tenant is a dedicated instance of Microsoft Entra ID, representing an organization. It's the container for all your users, groups, and app registrations. Subscriptions (like Azure or Microsoft 365) are linked to a tenant and provide the license to use specific cloud services." },
                    { title: "Initial Domain Configuration", details: "This involves adding and verifying your company's custom domain (e.g., `yourcompany.com`) to your Entra ID tenant. This allows users to have professional-looking usernames and email addresses (`user@yourcompany.com`) and helps establish your organization's brand identity within Microsoft 365." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/describe-function-identity-types-microsoft-entra-id/", youtubeId: "ThT3n2Yass4" }, 
                lab: { 
                    title: "Initial Tenant Configuration", 
                    steps: [
                        { 
                            id: 'w1s1', 
                            title: "Explore the Entra Portal",
                            introduction: "The Microsoft Entra admin center is your centralized hub for managing all aspects of your organization's identity and access management. This exercise will familiarize you with its layout and key features.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access the Portal</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open your browser and navigate to \`entra.microsoft.com\`</li>
                                            <li>Sign in with your Global Administrator credentials</li>
                                            <li>Notice the new modern interface design</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Explore Key Areas</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Find the Users section to manage user accounts</li>
                                            <li>Locate Groups for managing security and Microsoft 365 groups</li>
                                            <li>Explore Identity Governance for managing access lifecycle</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Review Dashboard</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Observe the Identity Secure Score</li>
                                            <li>Check for any security alerts or recommendations</li>
                                            <li>Note the tenant information and directory statistics</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/fundamentals/whatis",
                            troubleshooting: [
                                "If you can't access the portal, verify you're using the correct account with Global Administrator role",
                                "Clear browser cache if the dashboard doesn't load properly",
                                "Make sure you're using a modern browser (Edge, Chrome, Firefox)"
                            ]
                        },
                        { 
                            id: 'w1s2', 
                            title: "Configure Company Branding",
                            introduction: "Customizing your sign-in experience helps users recognize your organization's identity and builds trust. You'll configure basic branding elements that users will see when signing into Microsoft 365 services.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Branding Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to Identity > User experiences > Company branding</li>
                                            <li>Click "Configure" to start customization</li>
                                            <li>Note the preview pane that shows how changes will look</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Upload Brand Assets</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Prepare a square logo image (240x240 px recommended)</li>
                                            <li>Choose a background color that matches your brand</li>
                                            <li>Add your organization's name and helpdesk contact</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Test the Experience</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open an InPrivate/Incognito window</li>
                                            <li>Navigate to any Microsoft 365 service</li>
                                            <li>Verify your branding appears on the sign-in page</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            screenshot: true,
                            screenshotDetails: { src: 'img/branding.png', title: 'Company Branding Configuration' },
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/fundamentals/how-to-customize-branding",
                            troubleshooting: [
                                "If images don't upload, check they meet the size and format requirements",
                                "Allow up to 24 hours for branding changes to propagate globally",
                                "Test in different browsers as the experience might vary slightly"
                            ]
                        },
                        { 
                            id: 'w1s3', 
                            title: "Create Users & Groups",
                            introduction: "Now you'll create some test users and organize them into a security group. This is a fundamental skill for managing access and permissions in Microsoft 365.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Test Users</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Users > All users > New user</li>
                                            <li>Create 'Alex Wilber' with username 'alex@yourtenant.onmicrosoft.com'</li>
                                            <li>Create 'Megan Bowen' with appropriate licensing</li>
                                            <li>Add 'Patti Fernandez' with a strong password</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Set Up Security Group</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to Groups > All groups > New group</li>
                                            <li>Choose 'Security' as the group type</li>
                                            <li>Name it 'Sales Team' with appropriate description</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Add Members to Group</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select the new 'Sales Team' group</li>
                                            <li>Add Alex and Megan as members</li>
                                            <li>Verify membership in the group overview</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/fundamentals/how-to-manage-user-profile-info",
                            troubleshooting: [
                                "If user creation fails, check license availability",
                                "Ensure passwords meet complexity requirements",
                                "Verify group naming follows your organization's conventions"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Automate User Creation", text: "Write a PowerShell script using `Microsoft.Graph.Users` to create a fourth user and add them to the 'Sales Team' group. Save this as `New-M365User.ps1` in your GitHub repo." }, 
                gig: { title: "Entra ID Starter Pack", text: "Offer a fixed-fee service for initial M365 tenant setup, including branding, user/group creation, and a simple PowerShell script for future user management." }, 
                linkedinPost: "Week 1 of my M365 Consultant roadmap is complete! 🚀 This week, I focused on the core fundamentals of Microsoft Entra ID, setting up a new tenant, configuring branding, and automating user provisioning with PowerShell. Building a strong identity foundation is the first step in any Zero Trust journey.\n\n#Microsoft365 #EntraID #IdentityManagement #PowerShell #CloudConsulting #SC900 #LearnInPublic" 
            },
            2: { 
                feature: { title: "Conditional Access", text: "The 'if-then' policy engine of Entra ID. It processes signals like user, location, and device risk to enforce security policies, such as requiring MFA. It's the primary tool for implementing a Zero Trust strategy." }, 
                objectives: ["Block legacy authentication.", "Require MFA for specific roles or all users.", "Enforce security controls based on sign-in risk."], 
                concepts: [
                    { title: "The 'IF-THEN' Policy Model", details: "Conditional Access works on a simple but powerful logic: IF a user tries to access a resource, THEN enforce a specific condition. For example, IF a user is an administrator, THEN require multifactor authentication. This model allows for granular control over access." },
                    { title: "Signals (User, Location, Device, App)", details: "These are the 'IF' part of the policy. CA policies evaluate signals to make decisions. Signals include who the user is, their geographical location (based on IP address), the health and compliance of their device, and which application they are trying to access." },
                    { title: "Conditions (Risk, Platform, Location)", details: "Conditions are specific criteria applied to signals. You can create policies based on user or sign-in risk (e.g., from an unfamiliar location), the device platform (e.g., iOS, Windows), or specific network locations (e.g., trusted corporate network)." },
                    { title: "Grant vs. Block Controls", details: "These are the 'THEN' part of the policy. 'Block' simply denies access. 'Grant' controls allow access but can require specific actions to be completed first, such as providing MFA, using a compliant device, or agreeing to terms of use." },
                    { title: "Report-Only Mode", details: "This allows you to evaluate the impact of a Conditional Access policy without enforcing it. Sign-in logs will show the result of the policy ('Report-only: Success' or 'Report-only: Failure'), helping you test policies before they affect users." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/plan-implement-administer-conditional-access/", youtubeId: "QOLXaQ-3vjE" }, 
                lab: { 
                    title: "Baseline Security Policy Deployment", 
                    steps: [
                        {
                            id: 'w2s1',
                            title: "Block Legacy Authentication",
                            introduction: "Legacy authentication protocols like Basic Auth don't support modern security features like MFA. Blocking these protocols is a critical first step in securing your environment.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create the Policy</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to Entra ID > Security > Conditional Access</li>
                                            <li>Click "New policy" and name it "Block Legacy Authentication"</li>
                                            <li>Under "Common Policies", choose "Block legacy authentication"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Users</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Under Assignments > Users, select "All users"</li>
                                            <li>Consider excluding a break-glass admin account</li>
                                            <li>Note any service accounts that might need exclusion</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Set Conditions</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Under Client apps, select "Exchange ActiveSync" and "Other clients"</li>
                                            <li>Leave all other conditions at their defaults</li>
                                            <li>Review the policy summary to ensure accuracy</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-policy-legacy-auth",
                            troubleshooting: [
                                "If Outlook desktop stops working, verify the app is modern auth capable (2016 or later)",
                                "Check for any excluded locations or service principals",
                                "Monitor sign-in logs for legacy auth attempts"
                            ]
                        },
                        {
                            id: 'w2s2',
                            title: "Require MFA for Admins",
                            introduction: "Administrative accounts are prime targets for attackers. Requiring MFA for these high-privilege accounts is essential for protecting your environment.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Admin MFA Policy</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Create a new Conditional Access policy</li>
                                            <li>Name it "Require MFA for Admins"</li>
                                            <li>Set policy to "Report-only" initially</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Select Admin Roles</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Under Users > Directory roles, select all admin roles</li>
                                            <li>Include at minimum: Global, Security, and User admins</li>
                                            <li>Consider role-specific policies for granular control</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Grant Controls</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select "Grant access" and check "Require MFA"</li>
                                            <li>Enable the policy after testing in report-only</li>
                                            <li>Monitor admin sign-in experience</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-admin-mfa",
                            troubleshooting: [
                                "Ensure admins have registered MFA methods before enabling",
                                "Have a break-glass admin account excluded from MFA",
                                "Check for conflicting policies targeting the same roles"
                            ]
                        },
                        {
                            id: 'w2s3',
                            title: "Block High-Risk Sign-ins",
                            introduction: "Identity Protection uses machine learning to detect suspicious sign-in attempts. By blocking high-risk sign-ins, you can prevent potential account compromises.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Enable Identity Protection</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Verify Identity Protection is enabled in your tenant</li>
                                            <li>Review current risk detections</li>
                                            <li>Understand what constitutes "high risk"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Create Risk Policy</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Create policy named "Block High-Risk Sign-ins"</li>
                                            <li>Target all users (or start with pilot group)</li>
                                            <li>Under Conditions, select Sign-in risk = High</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Block Action</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Set access control to "Block access"</li>
                                            <li>Enable policy in report-only mode first</li>
                                            <li>Monitor for false positives before enforcing</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-risk",
                            troubleshooting: [
                                "Verify Azure AD P2 licensing for Identity Protection",
                                "Check sign-in logs to understand risk detection reasons",
                                "Have a process for users to report false positives"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Export Policy Definitions", text: "Export the JSON definition for your baseline policies. Commit them to GitHub with a `README.md` explaining the business purpose of each one." }, 
                gig: { title: "Conditional Access Health Check", text: "Offer to review a client's existing policies, analyze sign-in logs, and implement a baseline set of essential policies to improve their security posture." }, 
                linkedinPost: "Just wrapped up Week 2, diving deep into Microsoft Entra Conditional Access. I've configured a baseline of critical security policies: requiring MFA for admins, blocking legacy authentication, and preventing high-risk sign-ins. This is the core of a modern, identity-driven security posture. 🔒\n\n#Microsoft365 #EntraID #ConditionalAccess #ZeroTrust #Cybersecurity #SC300" 
            },
            3: { 
                feature: { title: "Privileged Identity Management (PIM)", text: "A governance service for Just-in-Time (JIT) access to privileged roles. Instead of permanent admin rights, users become 'eligible' and must activate their roles, drastically reducing the attack surface." }, 
                objectives: ["Implement the principle of least privilege.", "Configure time-bound, approval-based role activation.", "Audit and review privileged access history."], 
                concepts: [
                    { 
                        title: "Just-in-Time (JIT) Access",
                        details: `JIT is a fundamental security principle that transforms how privileged access is managed:
                        
                        • Instead of permanent admin rights, users get time-limited access
                        • Reduces attack surface by minimizing standing privileges
                        • Provides detailed audit trails of privilege usage
                        • Supports compliance requirements for privilege management
                        
                        Real-world example: A SharePoint admin needs to modify site collections once a week. Instead of having permanent admin rights, they activate the role only during their maintenance window, dramatically reducing the risk if their account is compromised.`
                    },
                    { 
                        title: "Eligible vs. Active Assignments",
                        details: `PIM introduces two key states for role assignments:
                        
                        Eligible Assignment:
                        • User is approved to request the role
                        • No active privileges until activated
                        • Can be permanent or time-bound eligibility
                        • Example: Help desk staff eligible for Password Admin role
                        
                        Active Assignment:
                        • Currently has role privileges
                        • Time-limited (e.g., 4 hours)
                        • Automatically expires
                        • Example: Database admin activates role for maintenance`
                    },
                    { 
                        title: "Role Activation Settings",
                        details: `Activation controls provide multiple security layers:
                        
                        1. Authentication Requirements:
                           • Require MFA for activation
                           • Enforce device compliance
                           • Location-based restrictions
                        
                        2. Approval Workflow:
                           • Multiple approvers support
                           • Time-based auto-approval
                           • Approval expiration settings
                        
                        3. Justification Requirements:
                           • Ticket number validation
                           • Business justification
                           • Incident reference
                        
                        Example: A security admin must provide a ServiceNow ticket number and get manager approval before activating Global Admin role.`
                    },
                    { 
                        title: "Access Reviews for Privileged Roles",
                        details: `Regular access reviews maintain security hygiene:
                        
                        1. Review Types:
                           • Self-review by users
                           • Manager review
                           • Security team review
                           • Multi-stage reviews
                        
                        2. Review Scope:
                           • All privileged roles
                           • Specific high-risk roles
                           • Custom role groupings
                        
                        3. Review Actions:
                           • Approve/Deny access
                           • Require justification
                           • Auto-remove on no response
                        
                        Best Practice: Schedule monthly reviews for critical roles (like Global Admin) and quarterly for other privileged roles.`
                    },
                    {
                        title: "Emergency Access Management",
                        details: `Critical for business continuity:
                        
                        1. Break-glass Accounts:
                           • Permanent admin accounts
                           • Strictly controlled access
                           • Regular credential rotation
                        
                        2. Emergency Scenarios:
                           • Azure AD outage
                           • MFA system failure
                           • Identity system issues
                        
                        3. Documentation Requirements:
                           • Access procedures
                           • Approval chain
                           • Usage logging
                        
                        Example: Store break-glass credentials in secured physical locations, requiring two authorized persons to access.`
                    }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/examine-privileged-identity-management/", youtubeId: "8N9QXl3iWL0" }, 
                lab: { 
                    title: "Configure JIT Access for an Administrator", 
                    steps: [
                        {
                            id: 'w3s1',
                            title: "Onboard a Role to PIM",
                            introduction: "PIM provides just-in-time privileged access control. We'll start by configuring PIM for one of the most critical roles: Global Administrator.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access PIM</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to Entra portal > Identity Governance</li>
                                            <li>Select Privileged Identity Management</li>
                                            <li>Review the PIM dashboard metrics</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Select Directory Roles</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Click 'Entra ID roles' in PIM</li>
                                            <li>Choose 'Roles' under Manage section</li>
                                            <li>Locate 'Global Administrator' role</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Review Current State</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Check existing role assignments</li>
                                            <li>Note any permanent members</li>
                                            <li>Review role activation history</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-getting-started",
                            troubleshooting: [
                                "Ensure you have Global Administrator or Privileged Role Administrator rights",
                                "Verify Azure AD Premium P2 licensing",
                                "Clear browser cache if PIM dashboard doesn't load"
                            ]
                        },
                        {
                            id: 'w3s2',
                            title: "Change Permanent to Eligible",
                            introduction: "Converting permanent role assignments to eligible assignments is a critical step in implementing least-privilege access. This reduces the attack surface by ensuring privileged access is only available when needed.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Identify Current Assignments</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Review current permanent assignments</li>
                                            <li>Document each user's business need</li>
                                            <li>Plan migration schedule</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Remove Permanent Access</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select user with permanent assignment</li>
                                            <li>Click 'Remove' to end permanent access</li>
                                            <li>Confirm the removal action</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Add Eligible Assignment</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Click 'Add assignments' in role</li>
                                            <li>Select same user, choose 'Eligible'</li>
                                            <li>Set appropriate assignment duration</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-resource-roles-assign-roles",
                            troubleshooting: [
                                "Keep at least one emergency access account with permanent access",
                                "Inform users before removing permanent access",
                                "Test eligible activation process before removing permanent access"
                            ]
                        },
                        {
                            id: 'w3s3',
                            title: "Configure Role Settings",
                            introduction: "Role settings define how users can activate their eligible roles, including authentication requirements, approval workflows, and time limits.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Role Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open Global Administrator role</li>
                                            <li>Go to Role settings</li>
                                            <li>Click Edit to modify settings</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Activation</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Set maximum activation duration (4 hours)</li>
                                            <li>Enable 'Require MFA on activation'</li>
                                            <li>Configure 'Require justification'</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Set Up Notifications</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Configure activation alerts</li>
                                            <li>Set up expiration notifications</li>
                                            <li>Add notification recipients</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-resource-roles-configure-role-settings",
                            troubleshooting: [
                                "Balance security requirements with usability",
                                "Consider time zones when setting activation duration",
                                "Test notification delivery to all recipients"
                            ]
                        },
                        {
                            id: 'w3s4',
                            title: "Activate the Role",
                            introduction: "Now we'll test the role activation process from an end-user perspective to ensure it works as expected and users understand the process.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access MyAccount Portal</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Sign in as eligible user</li>
                                            <li>Navigate to PIM section</li>
                                            <li>Locate 'My roles'</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Request Activation</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select Global Administrator role</li>
                                            <li>Click 'Activate'</li>
                                            <li>Complete MFA challenge</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Access</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Confirm activation success</li>
                                            <li>Test administrative actions</li>
                                            <li>Monitor activation expiration</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-resource-roles-activate-deactivate",
                            troubleshooting: [
                                "Ensure MFA is registered before attempting activation",
                                "Check activation history if request fails",
                                "Verify role settings if activation doesn't work"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Automate PIM Eligibility", text: "Create a PowerShell script using `Microsoft.Graph.Identity.Governance` to make a user eligible for a role with a time-bound assignment." }, 
                gig: { title: "PIM Implementation for Admins", text: "Offer a service to onboard a business's key admin roles into PIM, converting permanent assignments to eligible and configuring activation settings." }, 
                linkedinPost: "Week 3 complete! This week was all about the principle of least privilege using Privileged Identity Management (PIM). I've moved from standing admin access to Just-in-Time (JIT) eligible assignments with activation requirements. A huge step in reducing attack surface and a core skill for the AZ-500 and SC-300 exams.\n\n#Microsoft365 #PIM #JIT #Azure #Cybersecurity #CloudConsulting" 
            },
            4: { 
                feature: { title: "Microsoft Defender for Office 365", text: "Advanced email threat protection. 'Safe Attachments' sandboxes attachments and 'Safe Links' scans URLs at time-of-click. It uses AI to detect sophisticated phishing and impersonation attacks." }, 
                objectives: ["Protect against malicious attachments and links.", "Detect and prevent phishing and impersonation.", "Run attack simulations to test user awareness."], 
                concepts: [
                    {
                        title: "Safe Attachments & Safe Links",
                        details: `Microsoft's layered approach to email security:

                        Safe Attachments:
                        • Detonation: Files opened in isolated sandbox
                        • Dynamic Analysis: Observes file behavior
                        • Machine Learning: Identifies malicious patterns
                        • Zero-Day Protection: Catches unknown threats
                        
                        Safe Links:
                        • URL Rewriting: All links processed through Microsoft
                        • Time-of-Click Verification: Real-time URL scanning
                        • Post-Delivery Protection: Catches delayed attacks
                        • Click Tracking: Monitors user interactions
                        
                        Example: A PDF attachment containing a macro that tries to download malware is caught by Safe Attachments before reaching the user. A legitimate website that's later compromised is blocked by Safe Links when a user clicks, even though the email was clean at delivery.`
                    },
                    {
                        title: "Anti-phishing Policies",
                        details: `Advanced threat detection using multiple signals:

                        1. Authentication Checks:
                           • SPF validation
                           • DKIM verification
                           • DMARC compliance
                        
                        2. Machine Learning Models:
                           • Sender reputation
                           • Message content analysis
                           • Behavioral patterns
                        
                        3. Custom Settings:
                           • Allowed sender lists
                           • Blocked domains
                           • Confidence thresholds
                        
                        Real-world application: System detects an email appearing to come from your CFO but sent from a slightly different domain (e.g., company.com vs. cornpany.com).`
                    },
                    {
                        title: "Impersonation Protection",
                        details: `Targeted defense against social engineering:

                        1. Protected Users:
                           • Executive profiles
                           • Department heads
                           • Key external partners
                        
                        2. Detection Methods:
                           • Character substitution detection
                           • Similar domain analysis
                           • Communication pattern monitoring
                           • AI-based writing style analysis
                        
                        3. Protection Actions:
                           • Quarantine messages
                           • Add safety tips
                           • Alert security team
                        
                        Example: Automatically quarantines an email pretending to be your CEO asking for urgent wire transfer, even if sent from a convincing look-alike domain.`
                    },
                    {
                        title: "Attack Simulation Training",
                        details: `Comprehensive security awareness platform:

                        1. Simulation Types:
                           • Credential Harvest
                           • Attachment Malware
                           • Link in Attachment
                           • Drive-by URL
                           • Link to Malware
                        
                        2. Training Integration:
                           • Automatic enrollment
                           • Progress tracking
                           • Completion reporting
                        
                        3. Reporting Metrics:
                           • Click rates
                           • Reporting rates
                           • Training completion
                           • Behavior change
                        
                        Best Practice: Start with simple phishing scenarios and gradually increase complexity based on user improvement.`
                    },
                    {
                        title: "Threat Explorer",
                        details: `Security investigation and response tool:

                        1. Real-time Monitoring:
                           • Email flow analysis
                           • Threat patterns
                           • User activity
                           • File reputation
                        
                        2. Investigation Features:
                           • Advanced filtering
                           • Timeline analysis
                           • Similarity searching
                           • Campaign correlation
                        
                        3. Response Actions:
                           • Bulk message removal
                           • URL block
                           • File detonation
                           • User restriction
                        
                        Example: Security team uses Explorer to identify all recipients of a phishing campaign that was initially missed, then removes the messages from all mailboxes with one click.`
                    }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/remediate-risks-m365-defender-office-365/", youtubeId: "eUDv4lNrFGA" }, 
                lab: { 
                    title: "Configure MDO Policies & Run Attack Simulation", 
                    steps: [
                        {
                            id: 'w4s1',
                            title: "Configure Safe Attachments",
                            introduction: "Safe Attachments is Microsoft's sandbox technology that detonates email attachments in a secure environment to detect malicious behavior before delivery to users.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Defender Portal</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to \`security.microsoft.com\`</li>
                                            <li>Go to Email & Collaboration > Policies & rules</li>
                                            <li>Select Threat policies > Safe attachments</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Create Policy</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Name: "Block Malicious Attachments"</li>
                                            <li>Select "Block" for malware response</li>
                                            <li>Enable "Redirect detected malware"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Define Scope</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Apply to your domain</li>
                                            <li>Set priority number (lower = higher priority)</li>
                                            <li>Enable monitoring in audit mode first</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/safe-attachments-about",
                            troubleshooting: [
                                "Allow 30 minutes for policy to take effect",
                                "Check quarantine for false positives",
                                "Monitor email delivery delays during scanning"
                            ]
                        },
                        {
                            id: 'w4s2',
                            title: "Configure Safe Links",
                            introduction: "Safe Links provides time-of-click verification of URLs in emails and Office documents, protecting users from accessing malicious websites even if the link was safe at time of delivery.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Safe Links Policy</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Safe links section</li>
                                            <li>Create new policy named "URL Protection"</li>
                                            <li>Enable real-time URL scanning</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Protection Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Enable scan URLs in email messages</li>
                                            <li>Apply to Teams messages</li>
                                            <li>Set action for malicious URLs</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Set Up Notifications</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Customize warning pages</li>
                                            <li>Configure notification text</li>
                                            <li>Enable click tracking</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/safe-links-about",
                            troubleshooting: [
                                "Test with known malicious URLs from eicar.org",
                                "Check if rewritten URLs appear correctly",
                                "Verify Teams protection is working"
                            ]
                        },
                        {
                            id: 'w4s3',
                            title: "Run an Attack Simulation",
                            introduction: "Attack simulation training helps assess your organization's vulnerability to phishing attacks and provides automated training for users who fall for simulated attacks.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Plan Simulation</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Attack simulation training</li>
                                            <li>Choose "Credential Harvest" simulation</li>
                                            <li>Select or create phishing scenario</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Target Audience</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select test user group</li>
                                            <li>Exclude sensitive accounts</li>
                                            <li>Set delivery schedule</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Monitor Results</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Track who clicked/entered credentials</li>
                                            <li>Review training completion</li>
                                            <li>Generate executive summary</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulation-training-get-started",
                            troubleshooting: [
                                "Ensure users have valid licenses",
                                "Check spam filters aren't blocking simulation",
                                "Verify training assignments are working"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Document MDO Configuration & Simulation", text: "Create a `README.md` documenting your MDO policy settings. Include screenshots from the attack simulation, explaining how this data justifies security awareness training." }, 
                gig: { title: "Defender for Office 365 Health Check", text: "Offer to review a client's MDO policies against best practices, use the Configuration Analyzer to find gaps, and tune their settings." }, 
                linkedinPost: "Finished Week 4 by hardening the most common attack vector: email. I configured Microsoft Defender for Office 365 policies, including Safe Links and Safe Attachments, and ran a credential harvesting attack simulation to test the controls. A fantastic way to get hands-on with threat protection and generate data to justify security awareness training.\n\n#Microsoft365 #DefenderForOffice365 #ThreatProtection #Phishing #Cybersecurity" 
            },
            5: { 
                feature: { title: "Microsoft Purview DLP", text: "Helps identify, monitor, and automatically protect sensitive information (like credit card numbers or PII). Policies can prevent users from inappropriately sharing data via email, Teams, and SharePoint." }, 
                objectives: ["Identify sensitive information types.", "Create policies to prevent data exfiltration.", "Understand the end-user experience with policy tips."], 
                concepts: [
                    { title: "Sensitive Information Types (SITs)", details: "SITs are pattern-based classifiers that detect sensitive data. Purview includes over 100 built-in SITs (like Credit Card Number, Social Security Number). You can also create custom SITs to identify your organization's specific data, such as employee IDs or project codes." },
                    { title: "DLP Policies and Rules", details: "A DLP policy is a container for one or more rules. Each rule defines the conditions for the policy to trigger (e.g., content contains a SIT), and the actions to take (e.g., block sharing, show a policy tip). This allows for flexible and targeted data protection." },
                    { title: "Locations (Exchange, SharePoint, Teams)", details: "DLP policies can be applied across the M365 ecosystem. This includes Exchange Online (email), SharePoint Online and OneDrive for Business (files), and Microsoft Teams (chats and channel messages), providing consistent protection wherever your data lives." },
                    { title: "Policy Tips for Users", details: "Policy Tips are educational notifications that appear in real-time when a user is about to violate a DLP policy. For example, a tip might pop up in Outlook as someone is composing an email with sensitive data, informing them of the potential violation and guiding them toward compliant behavior." },
                    { title: "Alerting and Reporting", details: "DLP provides a rich dashboard for viewing policy matches and incidents. Administrators can configure alerts to be notified of high-severity or high-volume policy violations, allowing for prompt investigation and response." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/explore-examine-data-loss-prevention-microsoft-365/", youtubeId: "yajTwkAPN6Q" }, 
                lab: { 
                    title: "Create and Test a Financial Data DLP Policy", 
                    steps: [
                        {
                            id: 'w5s1',
                            title: "Explore Sensitive Info Types",
                            introduction: "Before creating a DLP policy, it's important to understand the types of sensitive data that Microsoft Purview can detect. This will help you choose the right templates and customize your policies effectively.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Purview Portal</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to \`compliance.microsoft.com\`</li>
                                            <li>Sign in with your admin credentials</li>
                                            <li>Note the compliance center's layout</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Review Built-in Types</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Data classification > Sensitive info types</li>
                                            <li>Search for "financial" to see relevant types</li>
                                            <li>Click on "Credit Card Number" to see its pattern</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Understand Detection Patterns</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Review the confidence levels (High/Medium/Low)</li>
                                            <li>Note the pattern matching criteria</li>
                                            <li>Observe supporting evidence requirements</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/purview/sensitive-information-type-entity-definitions",
                            troubleshooting: [
                                "Clear browser cache if the portal doesn't load properly",
                                "Ensure you have compliance admin privileges",
                                "Use Edge or Chrome for best portal experience"
                            ]
                        },
                        {
                            id: 'w5s2',
                            title: "Create a DLP Policy",
                            introduction: "Now we'll create a DLP policy to protect financial data. We'll use a template to speed up the process but customize it for our needs.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Start Policy Creation</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Data loss prevention > Policies</li>
                                            <li>Click "Create policy"</li>
                                            <li>Choose "Financial" category</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Policy Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Name the policy "Financial Data Protection"</li>
                                            <li>Select your country's financial template</li>
                                            <li>Choose locations: Exchange, SharePoint, Teams</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Define Protection Actions</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Set conditions for high volume of matches</li>
                                            <li>Configure policy tips for users</li>
                                            <li>Enable incident reports for admins</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/purview/create-test-tune-dlp-policy",
                            troubleshooting: [
                                "Start in test mode (audit only) before enforcing",
                                "Verify service connection status for all workloads",
                                "Check for conflicting policies"
                            ]
                        },
                        {
                            id: 'w5s3',
                            title: "Test the Policy",
                            introduction: "Testing is crucial to ensure the policy works as intended and users receive appropriate guidance. We'll simulate various scenarios to verify the policy's effectiveness.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Prepare Test Cases</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Create a test credit card number (4111111111111111)</li>
                                            <li>Prepare a test document with financial data</li>
                                            <li>Set up a test Teams channel</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Test in Different Apps</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Send a test email with the credit card number</li>
                                            <li>Upload the test document to SharePoint</li>
                                            <li>Share data in Teams chat</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Policy Actions</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Check if policy tips appear correctly</li>
                                            <li>Verify if blocking actions work</li>
                                            <li>Review the activity in DLP reports</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/purview/dlp-policy-tips-reference",
                            troubleshooting: [
                                "Allow up to 1 hour for policy to fully propagate",
                                "Check DLP reports for false positives",
                                "Verify user notifications are working in all apps"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "DLP Policy Design Document", text: "Create a design document defining the business requirement (protect financial data), the technical implementation (policy settings), and the expected user experience." }, 
                gig: { title: "DLP Policy Starter Pack", text: "Offer a package to deploy 1-2 template-based DLP policies in simulation mode, providing a one-week impact report to give clients a low-risk path toward compliance." }, 
                linkedinPost: "Week 5 focused on protecting data from the inside out with Microsoft Purview Data Loss Prevention (DLP). I created and tested a policy to identify and block the accidental sharing of financial data across Exchange, SharePoint, and Teams. A crucial skill for any organization focused on compliance and data governance.\n\n#Microsoft365 #Purview #DLP #DataGovernance #Compliance #SC900" 
            },
            6: { 
                feature: { title: "Purview eDiscovery & Sentinel", text: "eDiscovery is for identifying and preserving electronic information for legal cases. Sentinel is a cloud-native SIEM/SOAR solution that aggregates log data for threat detection and response." }, 
                objectives: ["Understand the eDiscovery workflow.", "Connect M365 logs to Microsoft Sentinel.", "Run a basic threat hunting query in Sentinel."], 
                concepts: [
                    { title: "eDiscovery (Standard vs. Premium)", details: "eDiscovery (Electronic Discovery) is the process of identifying and delivering electronic information that can be used as evidence in legal cases. Standard provides basic search and export, while Premium offers advanced features like case management, custodian communication, and analytics." },
                    { title: "Content Search & Holds", details: "Content Search is a tool to find data across M365 locations. A Hold (or Litigation Hold) preserves all content in place, preventing it from being deleted or altered by users. This is crucial for preserving potential evidence for legal or compliance reasons." },
                    { title: "SIEM vs. SOAR", details: "SIEM (Security Information and Event Management) tools like Sentinel collect, aggregate, and analyze log data to detect threats. SOAR (Security Orchestration, Automation, and Response) adds another layer, allowing you to automate responses to threats, such as blocking an IP address or disabling a user account." },
                    { title: "Data Connectors in Sentinel", details: "These are the integrations that feed log data into Sentinel. There are built-in connectors for all Microsoft services (like Entra ID, Defender) and many third-party products, allowing Sentinel to have a comprehensive view of activity across your entire digital estate." },
                    { title: "Kusto Query Language (KQL) Basics", details: "KQL is the powerful query language used in Sentinel (and other Azure services) to search through and analyze log data. It's essential for threat hunting, creating custom analytics rules, and building interactive workbooks (dashboards)." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/connect-microsoft-services-to-azure-sentinel/", youtubeId: "N-4-OK-g5_w" }, 
                lab: { 
                    title: "Mock Investigation & Sentinel Connection", 
                    steps: [
                        {
                            id: 'w6s1',
                            title: "Create an eDiscovery Case",
                            introduction: "eDiscovery (Standard) allows you to search, hold, and export content across M365 services. We'll create a case and perform a basic content search.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access eDiscovery</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to compliance.microsoft.com</li>
                                            <li>Go to eDiscovery > Standard</li>
                                            <li>Click "Create a case"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Case Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Name the case "Test Investigation"</li>
                                            <li>Add case members and roles</li>
                                            <li>Provide case description</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Run Content Search</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Create new search in the case</li>
                                            <li>Define search criteria for user emails</li>
                                            <li>Review and save the search</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/purview/ediscovery-get-started",
                            troubleshooting: [
                                "Verify you have eDiscovery Manager role",
                                "Ensure content locations are accessible",
                                "Check search syntax for accuracy"
                            ]
                        },
                        {
                            id: 'w6s2',
                            title: "Deploy Microsoft Sentinel",
                            introduction: "Microsoft Sentinel is a cloud-native SIEM/SOAR solution. We'll deploy a workspace to start collecting and analyzing security data.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Workspace</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Azure Portal</li>
                                            <li>Search for "Microsoft Sentinel"</li>
                                            <li>Create new Log Analytics workspace</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Enable Sentinel</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select your workspace</li>
                                            <li>Click "Add Microsoft Sentinel"</li>
                                            <li>Review pricing and confirm</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Set retention periods</li>
                                            <li>Configure access control</li>
                                            <li>Review workspace settings</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/azure/sentinel/quickstart-onboard",
                            troubleshooting: [
                                "Check Azure subscription permissions",
                                "Verify resource provider registration",
                                "Monitor deployment progress"
                            ]
                        },
                        {
                            id: 'w6s3',
                            title: "Connect M365 Data",
                            introduction: "To gain visibility into M365 activity, we'll connect key data sources to Sentinel using built-in connectors.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Data Connectors</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open Sentinel workspace</li>
                                            <li>Go to Data connectors</li>
                                            <li>Filter for Microsoft services</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Connectors</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Enable Entra ID connector</li>
                                            <li>Set up SharePoint Online</li>
                                            <li>Configure Exchange Online</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Data Flow</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Check connection status</li>
                                            <li>Monitor data ingestion</li>
                                            <li>Review any connector errors</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/azure/sentinel/connect-microsoft-365",
                            troubleshooting: [
                                "Verify admin consent for permissions",
                                "Check network connectivity",
                                "Allow time for initial data sync"
                            ]
                        },
                        {
                            id: 'w6s4',
                            title: "Run a KQL Query",
                            introduction: "Kusto Query Language (KQL) is used to analyze data in Sentinel. We'll start with a simple query to view sign-in logs.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Logs</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open Sentinel workspace</li>
                                            <li>Go to Logs view</li>
                                            <li>Clear any existing queries</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Write Query</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Enter \`SigninLogs\` table name</li>
                                            <li>Add \`| take 10\` operator</li>
                                            <li>Run the query</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Analyze Results</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Review sign-in events</li>
                                            <li>Note key columns</li>
                                            <li>Explore result filtering</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/",
                            troubleshooting: [
                                "Check table name capitalization",
                                "Verify data is being ingested",
                                "Allow time for log processing"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "eDiscovery SOP & Sentinel Guide", text: "Create an SOP for eDiscovery requests. Separately, document the steps to connect M365 data sources to Sentinel, explaining the value of each source." }, 
                gig: { title: "Sentinel Quick-Start for M365", text: "Offer a package to deploy Sentinel, connect essential M365 data connectors, and enable a baseline set of analytics rules for immediate security visibility." }, 
                linkedinPost: "Completed Week 6, bridging the gap between compliance and security operations. I ran a mock investigation with Purview eDiscovery and then piped all M365 logs into Microsoft Sentinel. Having a single pane of glass for threat hunting is a game-changer. 🕵️‍♂️\n\n#Microsoft365 #Sentinel #SIEM #eDiscovery #SecOps #AZ500" 
            },
            7: { 
                feature: { title: "Windows Autopilot & Intune", text: "A suite of technologies for setting up and pre-configuring new Windows devices, transforming them from factory state to business-ready with zero IT touch. The device joins Entra ID and enrolls in Intune automatically." }, 
                objectives: ["Prepare a device for Autopilot.", "Create and assign a deployment profile.", "Understand the end-user OOBE experience."], 
                concepts: [
                    { title: "User-Driven vs. Self-Deploying Mode", details: "User-Driven mode is for devices assigned to a specific user; the user signs in with their corporate credentials to start the process. Self-Deploying mode is for shared or kiosk devices; it's a zero-touch process that doesn't require any user credentials." },
                    { title: "Hardware Hash", details: "This is a unique identifier for a device's hardware (motherboard, MAC address, etc.). You upload this hash to the Autopilot service to pre-register the device with your organization. When the device connects to the internet for the first time, it contacts Microsoft, identifies itself with the hash, and gets redirected to your tenant's enrollment profile." },
                    { title: "Deployment Profiles", details: "This is where you configure the Autopilot experience. You can set things like whether the user is an administrator, skip the privacy and license agreement pages (OOBE), and customize the sign-in experience." },
                    { title: "Enrollment Status Page (ESP)", details: "The ESP is a crucial part of the user experience. It displays the progress of the device setup after the user signs in, showing which policies are being applied and which apps are being installed. It can be configured to block the user from accessing the desktop until all critical configurations are complete." },
                    { title: "Dynamic vs. Assigned Groups", details: "Assigned groups require you to manually add members. Dynamic groups automatically populate members based on rules. For Autopilot, a dynamic group can be created to automatically include all devices registered with the Autopilot service, simplifying the assignment of profiles and policies." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/configure-windows-autopilot-deployment-profile/", youtubeId: "f-a6fPrMhFQ" }, 
                lab: { 
                    title: "Configure a User-Driven Autopilot Profile", 
                    steps: [
                        {
                            id: 'w7s1',
                            title: "Get Hardware Hash",
                            introduction: "To register a device with Autopilot, we first need its unique hardware hash. This identifies the device to Microsoft and ensures it gets the right configuration.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Prepare PowerShell Environment</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open PowerShell as Administrator</li>
                                            <li>Verify script execution policy</li>
                                            <li>Install required PowerShell modules</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Install Script</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Run \`Install-Script -Name Get-WindowsAutopilotInfo\`</li>
                                            <li>Accept the prompts to install from PSGallery</li>
                                            <li>Verify script is installed</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Generate Hash</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Execute \`Get-WindowsAutopilotInfo.ps1\`</li>
                                            <li>Specify output path: \`C:\\device.csv\`</li>
                                            <li>Verify CSV file is created</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/autopilot/add-devices#collecting-the-hardware-hash-from-existing-devices",
                            troubleshooting: [
                                "Run PowerShell as Administrator if script fails",
                                "Check internet connectivity for script download",
                                "Verify PowerShell version is 5.1 or higher"
                            ]
                        },
                        {
                            id: 'w7s2',
                            title: "Import Device Hash",
                            introduction: "Now that we have the hardware hash, we'll import it into Intune to register the device with Autopilot.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Autopilot Devices</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to \`intune.microsoft.com\`</li>
                                            <li>Go to Devices > Windows > Windows enrollment</li>
                                            <li>Select Windows Autopilot devices</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Import Hash File</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Click "Import" in the command bar</li>
                                            <li>Browse and select your device.csv</li>
                                            <li>Confirm the import operation</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Registration</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Monitor import progress</li>
                                            <li>Check device appears in list</li>
                                            <li>Note assigned group tag if any</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/autopilot/add-devices",
                            troubleshooting: [
                                "Check CSV file format matches template",
                                "Allow up to 15 minutes for processing",
                                "Verify no duplicate entries exist"
                            ]
                        },
                        {
                            id: 'w7s3',
                            title: "Create Dynamic Device Group",
                            introduction: "Dynamic device groups automatically include Autopilot devices based on rules, making profile assignment easier.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Groups</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to Entra admin center</li>
                                            <li>Go to Groups > All groups</li>
                                            <li>Click "New group"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Choose Security group type</li>
                                            <li>Set Membership type to "Dynamic Device"</li>
                                            <li>Name the group "Autopilot Devices"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Define Dynamic Rule</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Add rule: \`(device.devicePhysicalIDs -any (_ -contains "[ZTDId]"))\`</li>
                                            <li>Save the rule</li>
                                            <li>Create the group</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/autopilot/enrollment-autopilot#create-an-autopilot-device-group",
                            troubleshooting: [
                                "Verify syntax of dynamic query",
                                "Check group creation permissions",
                                "Allow time for group membership to process"
                            ]
                        },
                        {
                            id: 'w7s4',
                            title: "Create Deployment Profile",
                            introduction: "The deployment profile determines how the device is configured during Autopilot setup, including what the user sees and what settings are applied.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Profile</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Intune > Devices > Enrollment</li>
                                            <li>Select "Deployment Profiles"</li>
                                            <li>Click "Create profile"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Choose "User-Driven" mode</li>
                                            <li>Configure OOBE settings</li>
                                            <li>Set computer name format</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Assign Profile</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Click "Assignments"</li>
                                            <li>Select your dynamic group</li>
                                            <li>Save and close</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/autopilot/profile-create",
                            troubleshooting: [
                                "Check profile is assigned to correct group",
                                "Verify all required settings are configured",
                                "Test with pilot group first"
                            ]
                        },
                        {
                            id: 'w7s5',
                            title: "Test Autopilot Deployment",
                            introduction: "Now we'll validate the entire process by resetting the device and watching it go through the Autopilot setup.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Reset Device</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open Windows Settings</li>
                                            <li>Choose System Reset option</li>
                                            <li>Remove everything</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Start Setup</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Connect to network</li>
                                            <li>Watch for Autopilot detection</li>
                                            <li>Sign in with test user</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Configuration</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Monitor ESP progress</li>
                                            <li>Confirm policies are applied</li>
                                            <li>Test configured features</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/autopilot/validate-deployment",
                            troubleshooting: [
                                "Ensure network connectivity during setup",
                                "Check ESP timeout settings",
                                "Monitor deployment progress in Intune"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "First-Time Autopilot Deployment Guide", text: "Document the entire Autopilot setup process in a `README.md`. Include the hardware hash capture script and explain the purpose of each step." }, 
                gig: { title: "Autopilot Proof-of-Concept (PoC) Setup", text: "Guide a company through their first Autopilot deployment. Help them configure profiles, create the dynamic group, and import the hardware hash for test devices." }, 
                linkedinPost: "Week 7 was all about modern endpoint management! I successfully configured a zero-touch deployment using Windows Autopilot and Microsoft Intune. Seeing a fresh VM transform into a business-ready device with no manual intervention is incredible. This is a core skill for the MD-102 exam.\n\n#Microsoft365 #Intune #Autopilot #MEM #MD102 #EndpointManagement" 
            },
            8: { 
                feature: { title: "Intune Compliance & App Protection", text: "Compliance policies define device health rules (e.g., BitLocker enabled). App Protection Policies (APP/MAM) protect corporate data *within an app* on unmanaged BYOD devices, preventing data leakage." }, 
                objectives: ["Define and enforce device compliance.", "Protect corporate data on unmanaged (BYOD) devices.", "Integrate compliance status with Conditional Access."], 
                concepts: [
                    { title: "Device Compliance Policies", details: "These are rules and settings that a device must meet to be considered 'compliant'. Examples include requiring a PIN, enabling encryption (BitLocker), and ensuring the OS version is up to date. Non-compliant devices can be blocked from accessing corporate resources." },
                    { title: "App Protection Policies (APP/MAM)", details: "Also known as Mobile Application Management (MAM), these policies protect corporate data at the application level. They are ideal for Bring-Your-Own-Device (BYOD) scenarios, as they can prevent data leakage (e.g., block copy/paste to personal apps) without Intune needing to fully manage the user's personal device." },
                    { title: "Managed Apps vs. Managed Devices", details: "A managed device is fully enrolled in Intune, giving IT full control over device settings and policies. A managed app is an application that has App Protection Policies applied to it. This allows IT to secure corporate data within the app, even if the device itself is not managed by Intune." },
                    { title: "Conditional Access Integration", details: "This is where compliance becomes powerful. You can create a Conditional Access policy that requires a device to be marked as 'compliant' by Intune before it can access corporate data. This ensures that only healthy and secure devices can connect to your services." },
                    { title: "Selective Wipe", details: "This is a key feature for BYOD. If an employee leaves the company, an administrator can issue a selective wipe command. This removes only the corporate data from the managed apps on the user's personal device, leaving all their personal data (photos, personal apps, etc.) untouched." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/create-device-compliance-policy/", youtubeId: "GFfiPz3B638" }, 
                lab: { 
                    title: "Enforce Device Health & Secure BYOD Apps", 
                    steps: [
                        {
                            id: 'w8s1',
                            title: "Create a Compliance Policy",
                            introduction: "Device compliance policies define the standards that devices must meet to be considered secure and granted access. We'll start by creating a policy requiring BitLocker encryption.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Compliance Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Intune > Devices > Compliance policies</li>
                                            <li>Click "Create Policy"</li>
                                            <li>Choose "Windows 10 and later" platform</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Requirements</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Name: "Windows Device Health"</li>
                                            <li>Enable BitLocker requirement</li>
                                            <li>Set Secure Boot requirement</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Set Schedule & Assign</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Define evaluation schedule</li>
                                            <li>Assign to test user group</li>
                                            <li>Review policy summary</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/intune/protect/compliance-policy-create-windows",
                            troubleshooting: [
                                "Check device has TPM for BitLocker",
                                "Verify required Windows edition",
                                "Allow time for policy to apply"
                            ]
                        },
                        {
                            id: 'w8s2',
                            title: "Create an App Protection Policy",
                            introduction: "App Protection Policies (also known as MAM) protect corporate data at the application level, making them perfect for BYOD scenarios where you can't manage the entire device.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Policy</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Intune > Apps > App protection policies</li>
                                            <li>Click "Create policy" and choose "Windows 10/11"</li>
                                            <li>Name it "BYOD App Protection"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Select Apps</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Add Microsoft Office apps</li>
                                            <li>Include Microsoft Edge</li>
                                            <li>Add OneDrive and Teams</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Protection</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Block copy/paste to unmanaged apps</li>
                                            <li>Enable PIN requirement</li>
                                            <li>Prevent Save As to personal storage</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/intune/apps/app-protection-policy",
                            troubleshooting: [
                                "Verify app versions are supported",
                                "Test with pilot group first",
                                "Check policy conflicts"
                            ]
                        },
                        {
                            id: 'w8s3',
                            title: "Update Conditional Access",
                            introduction: "Now we'll create a Conditional Access policy that requires devices to be marked as compliant before accessing Microsoft 365 resources. This ties together your compliance policies with access control.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create CA Policy</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Entra ID > Security > Conditional Access</li>
                                            <li>Create new policy named "Require Device Compliance"</li>
                                            <li>Set to Report-only mode initially</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Conditions</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Target Office 365 cloud apps</li>
                                            <li>Include pilot user group</li>
                                            <li>Apply to all device platforms</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Set Access Controls</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Choose Grant access</li>
                                            <li>Require device to be marked as compliant</li>
                                            <li>Enable policy after testing</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-compliant-device",
                            troubleshooting: [
                                "Test in report-only mode first",
                                "Have a break-glass account excluded",
                                "Monitor for false positives"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Compliance & BYOD Solution Brief", text: "Document your compliance policy and explain its synergy with Conditional Access. Create a separate brief explaining how App Protection Policies enable secure BYOD." }, 
                gig: { title: "BYOD Quick-Start with Intune APP", text: "Offer a package to configure and deploy App Protection Policies for core M365 apps, providing a significant security uplift with minimal user friction." }, 
                linkedinPost: "Finished Week 8, focusing on securing devices post-enrollment. I configured Intune compliance policies to enforce device health and integrated them with Conditional Access. Also implemented App Protection Policies (MAM) to enable secure BYOD by protecting corporate data inside apps. A comprehensive approach to endpoint security!\n\n#Microsoft365 #Intune #BYOD #MAM #MD102 #ZeroTrust" 
            },
            9: { 
                feature: { title: "Intune Suite Features", text: "Remote Help is a secure, cloud-based help desk solution. Tunnel for MAM is a per-app VPN for unmanaged BYOD devices, providing secure access to on-premises web apps from managed applications." }, 
                objectives: ["Set up and use Remote Help for support scenarios.", "Understand the architecture of Microsoft Tunnel for MAM.", "Configure policies for advanced Intune features."], 
                concepts: [
                    { title: "Remote Help RBAC", details: "Remote Help uses Intune's Role-Based Access Control (RBAC) to define who can do what. You can create tiered help desk roles, for example, giving a Tier 1 operator view-only permissions, while a Tier 2 operator can take full control of a user's screen." },
                    { title: "Microsoft Tunnel Gateway", details: "This is the server-side component of the Tunnel solution. It's a containerized application that runs on a Linux server (on-premises or in a VM) and acts as a secure gateway between BYOD devices on the internet and your internal corporate network." },
                    { title: "Per-App VPN vs. Device VPN", details: "A traditional device VPN routes all traffic from the device through the corporate network. Tunnel for MAM is a per-app VPN; only traffic from specific, managed applications (like Edge) is routed through the tunnel. This is more secure and preserves user privacy on BYOD devices." },
                    { title: "Endpoint Privilege Management", details: "This feature allows a standard user to run an application with administrative rights based on pre-approved rules. It helps organizations move away from making users local admins on their devices, which is a significant security risk, while still allowing them to perform necessary tasks." },
                    { title: "Advanced Endpoint Analytics", details: "This provides deep insights into the health, performance, and user experience of your endpoints. It can proactively identify issues, like devices with poor startup performance or apps that frequently crash, and provides recommended actions to resolve them." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/use-remote-help-intune-windows-devices/", youtubeId: "9Nal8u2BoEo" }, 
                lab: { 
                    title: "Set Up Remote Help & Tunnel for MAM", 
                    steps: [
                        {
                            id: 'w9s1',
                            title: "Enable Remote Help",
                            introduction: "Remote Help is a secure way for your help desk to provide remote assistance. We'll enable and configure it through the Intune Suite features.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Intune Suite</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Intune > Tenant admin</li>
                                            <li>Select Intune Suite</li>
                                            <li>Enable trial if not licensed</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Enable Remote Help</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Find Remote Help settings</li>
                                            <li>Toggle feature to Enabled</li>
                                            <li>Review default settings</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Settings</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Set session time limits</li>
                                            <li>Configure consent options</li>
                                            <li>Enable chat features</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/intune/remote-actions/remote-help",
                            troubleshooting: [
                                "Verify Intune Suite licensing",
                                "Check Windows version compatibility",
                                "Test network connectivity"
                            ]
                        },
                        {
                            id: 'w9s2',
                            title: "Configure RBAC for Help Desk",
                            introduction: "Role-Based Access Control (RBAC) lets you define exactly what help desk staff can do during remote sessions. We'll create a custom role for help desk operators.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Custom Role</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Tenant admin > Roles</li>
                                            <li>Click "Create new role"</li>
                                            <li>Name it "Help Desk Operator"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Assign Permissions</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Enable "View screen" permission</li>
                                            <li>Add "Take full control"</li>
                                            <li>Set elevation limitations</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Add Members</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select help desk group</li>
                                            <li>Set scope if needed</li>
                                            <li>Review assignments</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/intune/fundamentals/role-based-access-control",
                            troubleshooting: [
                                "Test role with limited scope first",
                                "Verify permission inheritance",
                                "Monitor role usage"
                            ]
                        },
                        {
                            id: 'w9s3',
                            title: "Configure Tunnel for MAM",
                            introduction: "Microsoft Tunnel for MAM enables managed apps on BYOD devices to securely access on-premises resources without requiring device enrollment.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Set Up Tunnel Site</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to Apps > Microsoft Tunnel for MAM</li>
                                            <li>Create new site configuration</li>
                                            <li>Define network settings</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Server</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Note: No actual deployment needed</li>
                                            <li>Review server requirements</li>
                                            <li>Plan capacity needs</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Update App Protection</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Modify existing APP policy</li>
                                            <li>Enable Tunnel integration</li>
                                            <li>Test configuration</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/mem/intune/protect/microsoft-tunnel-configure",
                            troubleshooting: [
                                "Check DNS configuration",
                                "Verify SSL certificates",
                                "Test with pilot devices"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Tiered Help Desk RBAC & Tunnel Architecture", text: "Document the RBAC configuration for a tiered help desk model. Create a separate architecture diagram for Microsoft Tunnel for MAM." }, 
                gig: { title: "Microsoft Tunnel for MAM Architecture Design", text: "Offer a design and planning service for Tunnel for MAM, documenting prerequisites and designing the necessary Intune policies." }, 
                linkedinPost: "Week 9 involved exploring the premium Intune Suite. I set up Remote Help with tiered RBAC for a secure help desk experience and configured the client-side policies for Microsoft Tunnel for MAM, a modern solution for providing per-app VPN access to on-prem resources on BYOD devices. High-value skills for advanced endpoint scenarios.\n\n#Microsoft365 #IntuneSuite #RemoteHelp #MicrosoftTunnel #MD102" 
            },
            10: { 
                feature: { title: "Power Platform", text: "A suite of low-code tools for building custom apps (Power Apps) and automating workflows (Power Automate). It empowers users to rapidly create solutions that connect to hundreds of data sources." }, 
                objectives: ["Build a simple canvas Power App.", "Create an automated approval workflow.", "Understand the role of Dataverse for Teams."], 
                concepts: [
                    { title: "Power Apps (Canvas vs. Model-Driven)", details: "Canvas apps give you a blank canvas and pixel-perfect control over the user interface, making them great for highly customized, task-specific apps. Model-driven apps are built on top of your data model in Dataverse and have a more standardized, less customizable UI, making them ideal for complex, process-driven applications." },
                    { title: "Power Automate (Cloud Flows)", details: "Power Automate lets you create automated workflows between your favorite apps and services. These 'flows' can be triggered by an event (e.g., a new email arrives) or run on a schedule. They consist of a series of actions that can perform tasks like sending notifications, collecting data, and synchronizing files." },
                    { title: "Connectors", details: "Connectors are the bridges that allow Power Apps and Power Automate to communicate with other services. There are hundreds of connectors for Microsoft services (like SharePoint, Outlook) and third-party services (like Twitter, Salesforce, Dropbox), enabling powerful integrations." },
                    { title: "Triggers and Actions", details: "In Power Automate, a Trigger is the event that starts a flow (e.g., 'When a new item is created in the SharePoint list'). An Action is the task that the flow performs (e.g., 'Send an email'). A single flow can have one trigger and many actions." },
                    { title: "SharePoint as a Data Source", details: "SharePoint lists are a very common and accessible data source for the Power Platform. They are easy to set up, included with most M365 licenses, and integrate seamlessly, making them a perfect starting point for building simple apps and flows without needing a premium database." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/paths/power-platform-fundamentals/", youtubeId: "rJsHc-4w60g" }, 
                lab: { 
                    title: "Create a Leave Request App & Approval Flow", 
                    steps: [
                        {
                            id: 'w10s1',
                            title: "Create a SharePoint List",
                            introduction: "SharePoint lists provide an excellent data source for Power Platform solutions. We'll create a list to store leave request information.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create List</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open SharePoint site</li>
                                            <li>Click "New > List"</li>
                                            <li>Name it "Leave Requests"</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Add Columns</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Add "Start Date" (Date type)</li>
                                            <li>Add "End Date" (Date type)</li>
                                            <li>Add "Status" (Choice type)</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Options</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Set Status choices: Pending, Approved, Rejected</li>
                                            <li>Add "Comments" (Multiple lines)</li>
                                            <li>Configure default views</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/sharepoint/create-list-overview",
                            troubleshooting: [
                                "Check column name restrictions",
                                "Verify permissions",
                                "Test data entry"
                            ]
                        },
                        {
                            id: 'w10s2',
                            title: "Create a Power App",
                            introduction: "Power Apps makes it easy to create a mobile-friendly interface for submitting and viewing leave requests. We'll start with the auto-generated app and customize it.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Generate App</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>From SharePoint list, click Integrate</li>
                                            <li>Choose Power Apps > Create an app</li>
                                            <li>Wait for app generation</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Customize Screens</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Modify BrowseScreen layout</li>
                                            <li>Enhance EditScreen form</li>
                                            <li>Add validation to dates</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Test and Save</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Preview the app</li>
                                            <li>Test all functions</li>
                                            <li>Save and publish</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/power-apps/customize-list-form",
                            troubleshooting: [
                                "Check data connections",
                                "Verify formulas syntax",
                                "Test on mobile devices"
                            ]
                        },
                        {
                            id: 'w10s3',
                            title: "Create a Power Automate Flow",
                            introduction: "We'll automate the approval process using Power Automate. When a new request is submitted, it will trigger an approval workflow and update the request status.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Create Flow</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Go to make.powerautomate.com</li>
                                            <li>Create automated cloud flow</li>
                                            <li>Choose SharePoint trigger</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Add Approval</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Add "Start and wait for approval"</li>
                                            <li>Configure approver details</li>
                                            <li>Customize approval email</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Update Status</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Add condition for approval outcome</li>
                                            <li>Update SharePoint item</li>
                                            <li>Send notification emails</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/power-automate/get-started-logic-flow",
                            troubleshooting: [
                                "Check connection references",
                                "Test approval routing",
                                "Monitor flow runs"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Solution Brief: Automated Leave Request System", text: "Create a `README.md` with screenshots of the Power App and a diagram of the Power Automate flow. Explain the business value." }, 
                gig: { title: "SharePoint Form and Approval Flow Automation", text: "Offer a package to digitize a client's paper or email-based form using a SharePoint list, a Power App, and a Power Automate approval flow." }, 
                linkedinPost: "This week (Week 10) I stepped into the world of low-code development with the Power Platform. I built a functional Leave Request system using a SharePoint list, a Power App for the front-end, and a Power Automate flow for the approval logic. It's amazing how quickly you can build and deploy valuable business solutions!\n\n#Microsoft365 #PowerPlatform #PowerApps #PowerAutomate #LowCode" 
            },
            11: { 
                feature: { title: "Microsoft Graph & SPFx", text: "Microsoft Graph is the single, unified REST API for all M365 data. The SharePoint Framework (SPFx) is the model for building client-side customizations for SharePoint, Teams, and Viva." }, 
                objectives: ["Query M365 data using Graph Explorer.", "Set up an SPFx development environment.", "Build and deploy a simple 'Hello World' web part."], 
                concepts: [
                    { title: "Microsoft Graph API Endpoints", details: "Microsoft Graph provides a single, unified programming interface to access data across M365. The API is organized into endpoints, which are URLs you can query to interact with specific services. For example, the `/me` endpoint gets the current user's profile, and `/me/messages` gets their emails." },
                    { title: "Graph Explorer", details: "This is a web-based tool provided by Microsoft that lets you experiment with Microsoft Graph APIs. You can make queries, see the responses, and discover what data is available without writing any code. It's an essential tool for learning and development." },
                    { title: "SharePoint Framework (SPFx)", details: "SPFx is a modern, client-side development model for building customizations on SharePoint, Microsoft Teams, and Viva Connections. It's based on open-source technologies like TypeScript and React, and it ensures that customizations are responsive, performant, and secure." },
                    { title: "Node.js, Gulp, and Yeoman", details: "These are the open-source tools that form the build toolchain for SPFx. Node.js is the JavaScript runtime, Yeoman (`yo`) is a scaffolding tool that creates the initial project structure, and Gulp is a task runner that handles compiling, bundling, and serving your code." },
                    { title: "Web Parts", details: "Web Parts are the fundamental building blocks of pages in SharePoint. With SPFx, you can build your own custom web parts using modern web technologies. These web parts can then be added to SharePoint pages or exposed as tabs in Microsoft Teams." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/paths/m365-msgraph-fundamentals/", youtubeId: "eKq56vN5d_s" }, 
                lab: { 
                    title: "Explore Graph API & Build a 'Hello World' Web Part", 
                    steps: [
                        {
                            id: 'w11s1',
                            title: "Use Graph Explorer",
                            introduction: "Graph Explorer is an interactive tool for testing Microsoft Graph APIs. We'll use it to understand what data is available and how to query it.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Graph Explorer</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Navigate to developer.microsoft.com/graph/graph-explorer</li>
                                            <li>Sign in with your account</li>
                                            <li>Review available permissions</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Try Sample Queries</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Run \`/me\` query</li>
                                            <li>Try \`/me/messages\`</li>
                                            <li>Explore \`/users\` endpoint</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Examine Responses</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Review JSON structure</li>
                                            <li>Note required permissions</li>
                                            <li>Try modifying queries</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/graph/graph-explorer/graph-explorer-overview",
                            troubleshooting: [
                                "Check authentication status",
                                "Verify required permissions",
                                "Review error responses"
                            ]
                        },
                        {
                            id: 'w11s2',
                            title: "Set up SPFx Environment",
                            introduction: "The SharePoint Framework (SPFx) requires a specific development environment setup. We'll install the necessary tools and verify the configuration.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Install Prerequisites</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Download Node.js LTS version</li>
                                            <li>Install Node.js and npm</li>
                                            <li>Verify installation with \`node -v\`</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Install Global Tools</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Run \`npm install -g @microsoft/generator-sharepoint\`</li>
                                            <li>Install Yeoman: \`npm install -g yo\`</li>
                                            <li>Add Gulp: \`npm install -g gulp-cli\`</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Setup</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Check versions: \`yo --version\`</li>
                                            <li>Verify gulp: \`gulp --version\`</li>
                                            <li>Test SPFx generator: \`yo @microsoft/sharepoint --version\`</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/sharepoint/dev/spfx/set-up-your-development-environment",
                            troubleshooting: [
                                "Clear npm cache if install fails",
                                "Check Node.js version compatibility",
                                "Verify system PATH variables"
                            ]
                        },
                        {
                            id: 'w11s3',
                            title: "Create and Run a Web Part",
                            introduction: "Now we'll create our first SPFx web part, a 'Hello World' component that demonstrates the basic structure and development workflow.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Generate Project</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Create project folder</li>
                                            <li>Run \`yo @microsoft/sharepoint\`</li>
                                            <li>Choose WebPart template</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Configure Project</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Name solution and web part</li>
                                            <li>Select React framework</li>
                                            <li>Run \`npm install\`</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Test Web Part</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Run \`gulp serve\`</li>
                                            <li>Open workbench</li>
                                            <li>Add web part to page</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/get-started/build-a-hello-world-web-part",
                            troubleshooting: [
                                "Check for build errors",
                                "Verify localhost certificate",
                                "Clear browser cache"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Governance Script & SPFx Project", text: "Write a PowerShell script to find all ownerless M365 Groups. Separately, push your entire SPFx project folder to GitHub with a `README.md`." }, 
                gig: { title: "Custom M365 Governance Report Script", text: "Offer to write custom PowerShell scripts using the Microsoft Graph SDK to generate reports that aren't available in the standard admin centers." }, 
                linkedinPost: "Week 11 was a dive into code! I spent the week querying the Microsoft Graph API, both in the Graph Explorer and with PowerShell, to pull M365 data. Then I set up my first SharePoint Framework (SPFx) project to build a custom web part. A great introduction to M365 development.\n\n#Microsoft365 #MicrosoftGraph #SPFx #SharePoint #Development" 
            },
            12: { 
                feature: { title: "Teams App Publishing & Capstone", text: "Extend the reach of custom applications by publishing them to Microsoft Teams. Publishing an SPFx web part as a Teams tab is a low-friction way to create a rich, integrated Teams application." }, 
                objectives: ["Deploy an SPFx solution to the App Catalog.", "Make an SPFx web part available in Teams.", "Understand the app packaging and manifest file."], 
                concepts: [
                    { title: "SharePoint App Catalog", details: "The App Catalog is a special site collection in SharePoint where you upload and manage custom solutions like SPFx web parts. Once a solution is deployed to the App Catalog, it can be made available for installation on other sites in the tenant." },
                    { title: "Sync to Teams", details: "This is a feature in the SharePoint App Catalog. When you have an SPFx solution that is configured to also be a Teams app, clicking the 'Sync to Teams' button automatically creates the necessary app manifest and makes it available in the Microsoft Teams app store for your organization." },
                    { title: "Teams App Manifest", details: "This is a JSON file (`manifest.json`) that defines your Teams application. It contains information like the app's name, icons, and what capabilities it has (e.g., tabs, bots). When you use 'Sync to Teams' for an SPFx solution, this manifest is generated for you." },
                    { title: "App Customization in Teams Admin Center", details: "The Teams Admin Center allows administrators to manage all the apps available to their users. They can upload custom apps, pin apps to the sidebar for all users, and create policies to control which users can access which apps." }
                ], 
                resources: { learn: "https://learn.microsoft.com/en-us/training/modules/microsoft-teams-publish-app-org/", youtubeId: "Knv5ErWSE_0" }, 
                lab: { 
                    title: "Deploy Your SPFx Web Part as a Teams Tab", 
                    steps: [
                        {
                            id: 'w12s1',
                            title: "Package the SPFx Solution",
                            introduction: "Before we can deploy our web part, we need to create a production-ready package. This involves bundling and packaging the solution.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Bundle Solution</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open terminal in project folder</li>
                                            <li>Run \`gulp bundle --ship\`</li>
                                            <li>Verify no build errors</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Create Package</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Run \`gulp package-solution --ship\`</li>
                                            <li>Check \`sharepoint/solution\` folder</li>
                                            <li>Verify .sppkg file exists</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Review Package</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Check manifest settings</li>
                                            <li>Verify Teams property</li>
                                            <li>Note package version</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/get-started/hosting-webpart-from-office-365-cdn",
                            troubleshooting: [
                                "Clear temp files if build fails",
                                "Check manifest version",
                                "Verify all assets are included"
                            ]
                        },
                        {
                            id: 'w12s2',
                            title: "Deploy to App Catalog",
                            introduction: "The App Catalog is where we publish our SPFx solution for tenant-wide availability. We'll upload our package and configure its deployment settings.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access App Catalog</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open SharePoint admin center</li>
                                            <li>Navigate to App Catalog</li>
                                            <li>Select Apps for SharePoint</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Upload Package</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Click Upload and select .sppkg</li>
                                            <li>Enable tenant-wide deployment</li>
                                            <li>Check deployment options</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Deployment</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Confirm successful upload</li>
                                            <li>Check solution status</li>
                                            <li>Review deployment details</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/get-started/deploy-web-part-to-cdn",
                            troubleshooting: [
                                "Verify admin permissions",
                                "Check CDN settings",
                                "Monitor deployment logs"
                            ]
                        },
                        {
                            id: 'w12s3',
                            title: "Sync to Teams",
                            introduction: "With our solution deployed to SharePoint, we can now make it available in Teams. The 'Sync to Teams' feature automates the Teams app manifest creation.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Prepare for Teams</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Verify Teams integration settings</li>
                                            <li>Check manifest properties</li>
                                            <li>Review Teams requirements</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Sync Solution</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Select solution in App Catalog</li>
                                            <li>Click "Sync to Teams"</li>
                                            <li>Monitor sync progress</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Verify Teams App</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open Teams admin center</li>
                                            <li>Check apps list</li>
                                            <li>Review app status</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/get-started/using-web-part-as-ms-teams-tab",
                            troubleshooting: [
                                "Check Teams app policies",
                                "Verify manifest settings",
                                "Monitor sync status"
                            ]
                        },
                        {
                            id: 'w12s4',
                            title: "Add as a Teams Tab",
                            introduction: "Finally, we'll add our web part as a tab in a Teams channel, testing the end-user experience of our deployed solution.",
                            details: `
                                <ol class="list-decimal list-inside space-y-3">
                                    <li class="mb-2">
                                        <span class="font-medium">Access Teams</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Open Microsoft Teams</li>
                                            <li>Select target channel</li>
                                            <li>Click + to add tab</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Add Web Part</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Search for your app</li>
                                            <li>Configure web part settings</li>
                                            <li>Save and test</li>
                                        </ul>
                                    </li>
                                    <li class="mb-2">
                                        <span class="font-medium">Test Integration</span>
                                        <ul class="list-disc list-inside ml-6 mt-1 text-sm space-y-1">
                                            <li>Verify tab loads correctly</li>
                                            <li>Test all functionality</li>
                                            <li>Check mobile experience</li>
                                        </ul>
                                    </li>
                                </ol>
                            `,
                            sourceUrl: "https://learn.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/get-started/using-web-part-as-ms-teams-tab#add-the-web-part-as-a-teams-tab",
                            troubleshooting: [
                                "Check Teams permissions",
                                "Verify SharePoint connection",
                                "Test in different clients"
                            ]
                        }
                    ]
                }, 
                portfolio: { title: "Finalize Portfolio and Plan Next Steps", text: "Update your SPFx project's `README.md` to include deployment steps for both SharePoint and Teams. Conduct a full review of your 12-week portfolio." }, 
                gig: { title: "SPFx to Teams Tab Deployment Service", text: "Offer a service to take a client's existing SPFx web part package, deploy it to their App Catalog, and manage the 'Sync to Teams' process." }, 
                linkedinPost: "And that's a wrap on my 12-week M365 Consultant roadmap! The capstone project was deploying my SPFx web part as a Microsoft Teams tab, demonstrating the 'build once, run anywhere' power of the platform. My GitHub portfolio is polished and I'm ready for the next step: certifications! It's been an incredible learning journey.\n\n#Microsoft365 #TeamsDev #SPFx #Portfolio #CloudConsulting #Finished" 
            },
        };
        let currentWeek = 1, todoState = {}, totalTasks = 0, notesState = {};
        
        const createContentCard = (week) => {
            const data = contentData[week];
            const weeklyInfo = weeklyData.find(w => w.week === week);
            const createTodoList = (steps) => steps.map(step => `
                <div class="lab-step border rounded-lg overflow-hidden mb-4 shadow-sm hover:shadow-md transition-shadow" style="border-color: var(--border-color);">
                    <div class="todo-item ${todoState[step.id] ? 'is-checked' : ''}">
                        <input type="checkbox" id="${step.id}" data-todoid="${step.id}" class="sr-only" ${todoState[step.id] ? 'checked' : ''}>
                        <label for="${step.id}" class="lab-step-header flex items-center p-4 cursor-pointer transition-colors duration-200" style="background-color: var(--highlight-bg-color);">
                            <div class="w-6 h-6 border-2 rounded-full mr-3 flex-shrink-0 flex items-center justify-center transition-colors duration-200" style="border-color: var(--primary-color);">
                                <div class="w-3 h-3 rounded-full bg-transparent checkmark transition-colors duration-200"></div>
                            </div>
                            <span class="font-semibold flex-grow step-title text-lg">${step.title}</span>
                            ${step.screenshot? `<button class="screenshot-btn text-sm font-medium ml-4 shrink-0 px-3 py-1.5 rounded hover:bg-opacity-90 transition-all" style="color: var(--primary-color); border: 1px solid var(--primary-color);">View Screenshot</button>` : ''}
                            <button class="expand-btn ml-4 p-2 rounded-full hover:bg-opacity-10 transition-all" style="background-color: var(--primary-color); background-opacity: 0.1;">
                                <svg class="w-6 h-6 transform transition-transform duration-200 accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                </svg>
                            </button>
                        </label>
                        <div class="lab-step-content overflow-hidden" style="max-height: 0; transition: max-height 0.3s ease-out;">
                            <div class="p-6 border-t space-y-4" style="background-color: var(--card-bg-color); border-color: var(--border-color);">
                                <div class="lab-step-introduction mb-4 text-sm" style="color: var(--text-muted-color);">
                                    ${step.introduction || ''}
                                </div>
                                <div class="lab-step-instructions space-y-3">
                                    ${step.details}
                                </div>
                                ${step.sourceUrl ? `
                                <div class="mt-4 pt-4 border-t" style="border-color: var(--border-color);">
                                    <a href="${step.sourceUrl}" target="_blank" class="inline-flex items-center text-sm" style="color: var(--primary-color);">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                                        </svg>
                                        View Official Documentation
                                    </a>
                                </div>` : ''}
                                ${step.troubleshooting ? `
                                <div class="mt-4 p-4 rounded-lg space-y-2" style="background-color: var(--highlight-bg-color);">
                                    <h4 class="font-semibold">Troubleshooting Tips:</h4>
                                    <ul class="list-disc list-inside text-sm space-y-1">
                                        ${step.troubleshooting.map(tip => `<li>${tip}</li>`).join('')}
                                    </ul>
                                </div>` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            const createCertSpotlight = (certs) => certs.map(cert => `
                <a href="https://learn.microsoft.com/en-us/certifications/${cert.toLowerCase()}" target="_blank" class="flex items-center p-2 rounded-lg transition hover:bg-sky-100 dark:hover:bg-sky-900">
                    <img src="https://img.shields.io/badge/${cert}-0078D4?style=for-the-badge&logo=microsoft" alt="${cert} Certification" class="h-6">
                </a>
            `).join('');

            const hasSim = [2, 7].includes(week);
            return `<div id="week-${week}-content" class="content-card p-4 space-y-8" data-week="${week}">
                 <header class="mb-8">
                    <h1 class="text-4xl font-bold" style="color: var(--heading-color);">${weeklyInfo.title}</h1>
                    <p class="mt-2" style="color: var(--text-muted-color);">${weeklyInfo.theme}</p>
                </header>
                <div class="border-b pb-4" style="border-color: var(--border-color);">
                    <nav class="-mb-px flex flex-wrap justify-start" aria-label="Tabs">
                        <button class="tab-button active py-4 px-3 border-b-2 font-medium text-sm" data-tab="details" data-week="${week}">Details</button>
                        <button class="tab-button py-4 px-3 border-b-2 font-medium text-sm" data-tab="lab" data-week="${week}">Hands-on Lab</button>
                        ${hasSim? `<button class="tab-button py-4 px-3 border-b-2 font-medium text-sm" data-tab="sim" data-week="${week}">Sandbox Simulation</button>` : ''}
                        <button class="tab-button py-4 px-3 border-b-2 font-medium text-sm" data-tab="notes" data-week="${week}">My Notes</button>
                        <button class="tab-button py-4 px-3 border-b-2 font-medium text-sm" data-tab="portfolio" data-week="${week}">Consultant's Corner</button>
                    </nav>
                </div>
                <div class="tab-content" data-tab-content="details" data-week="${week}">
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-xl font-semibold mb-3" style="color: var(--primary-color);">Learning Objectives</h4>
                            <ul class="list-disc list-inside space-y-1 text-sm">${data.objectives.map(o => `<li>${o}</li>`).join('')}</ul>
                        </div>
                        <div>
                            <h4 class="text-xl font-semibold mb-3" style="color: var(--primary-color);">Key Concepts</h4>
                            <div class="space-y-4">
                                ${data.concepts.map(c => `
                                    <div class="p-4 rounded-lg" style="background-color: var(--highlight-bg-color);">
                                        <h5 class="font-semibold">${c.title}</h5>
                                        <p class="text-sm mt-1" style="color: var(--text-muted-color);">${c.details}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 p-4 rounded-lg" style="background-color: var(--highlight-bg-color);">
                        <h4 class="text-xl font-semibold mb-3" style="color: var(--primary-color);">Certification Spotlight</h4>
                        <div class="flex flex-wrap gap-2">${createCertSpotlight(weeklyInfo.certs)}</div>
                    </div>
                     <div class="mt-6">
                        <h4 class="text-xl font-semibold mb-3" style="color: var(--primary-color);">Video Lesson</h4>
                        <div class="aspect-w-16 aspect-h-9 rounded-lg overflow-hidden"><iframe src="https://www.youtube.com/embed/${data.resources.youtubeId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full"></iframe></div>
                    </div>
                </div>
                <div class="tab-content hidden" data-tab-content="lab" data-week="${week}">
                    <h4 class="text-xl font-semibold mb-4 text-center" style="color: var(--primary-color);">${data.lab.title}</h4>
                    <div class="space-y-4 max-w-3xl mx-auto lab-container">${createTodoList(data.lab.steps)}</div>
                    <div class="text-center mt-8">
                        <button id="share-week-${week}" class="share-button px-6 py-2 rounded-lg text-white font-semibold transition transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed" style="background-color: #0077B5;" disabled>
                            Share My Success on LinkedIn
                        </button>
                        <p id="share-helper-week-${week}" class="text-sm mt-2" style="color: var(--text-muted-color);">Complete all lab steps to enable sharing.</p>
                    </div>
                </div>
                ${hasSim && week === 2? createSimContentCA() : ''}
                ${hasSim && week === 7? createSimContentAutopilot() : ''}
                <div class="tab-content hidden" data-tab-content="notes" data-week="${week}"><h4 class="text-xl font-semibold mb-3 text-center" style="color: var(--primary-color);">My Notes for Week ${week}</h4><textarea id="notes-week-${week}" class="w-full h-64 p-2 border rounded" style="border-color: var(--border-color); background-color: var(--card-bg-color);" placeholder="Jot down your thoughts, questions, and key takeaways..."></textarea></div>
                <div class="tab-content hidden" data-tab-content="portfolio" data-week="${week}">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="p-4 rounded-lg" style="background-color: var(--highlight-bg-color);">
                            <h4 class="text-xl font-semibold mb-3" style="color: var(--primary-color);">Portfolio Task</h4>
                            <p>${data.portfolio.text}</p>
                        </div>
                        <div class="p-4 rounded-lg" style="background-color: var(--highlight-bg-color);">
                            <h4 class="text-xl font-semibold mb-3" style="color: var(--primary-color);">Micro-Gig Idea</h4>
                            <p>${data.gig.text}</p>
                        </div>
                    </div>
                </div>
            </div>`;
        };
        const createSimContentCA = () => `<div class="tab-content hidden" data-tab-content="sim" data-week="2"><h4 class="text-xl font-semibold mb-4 text-center" style="color: var(--primary-color);">Sim Lab: Create a Conditional Access Policy</h4><div class="sim-container rounded-lg overflow-hidden max-w-4xl mx-auto"><div class="sim-header p-2 text-sm font-semibold">Microsoft Entra admin center</div><div class="flex h-[500px]"><div class="sim-sidebar w-1/4 p-2 space-y-1 text-sm"><div class="p-2 rounded cursor-pointer sim-menu-item" id="sim-ca-menu-home">Home</div><div class="p-2 rounded cursor-pointer sim-menu-item" id="sim-ca-menu-protection">Protection</div><div class="p-2 rounded cursor-pointer sim-menu-item" id="sim-ca-menu-ca"> &nbsp; &nbsp; ↳ Conditional Access</div><div class="p-2 rounded cursor-pointer sim-menu-item" id="sim-ca-menu-users">Users</div></div><div class="w-3/4 p-4 relative overflow-y-auto" id="sim-ca-main-content"><div id="sim-ca-blade-ca" class="sim-blade p-4 hidden"><h2 class="text-lg font-bold mb-4">Conditional Access | Policies</h2><button id="sim-ca-btn-new-policy" class="sim-btn px-3 py-1 rounded text-sm">+ New policy</button></div><div id="sim-ca-blade-new-policy" class="sim-blade p-4 hidden"><h2 class="text-lg font-bold mb-4">New policy</h2><label class="block mb-2">Name</label><input id="sim-ca-input-name" type="text" class="w-full p-1 border rounded mb-4" style="background-color: var(--bg-color); border-color: var(--border-color);"><h3 class="font-semibold mb-2">Assignments</h3><div id="sim-ca-link-users" class="p-2 rounded cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700">👤 Users</div><h3 class="font-semibold mt-4 mb-2">Access controls</h3><div id="sim-ca-link-grant" class="p-2 rounded cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700">✅ Grant</div><div class="mt-6 text-right"><button id="sim-ca-btn-create" class="sim-btn px-4 py-2 rounded" disabled>Create</button></div></div><div id="sim-ca-blade-success" class="text-center p-8 hidden"><div class="text-5xl mb-4">🎉</div><h2 class="text-2xl font-bold" style="color: var(--success-text-color);">Policy Created!</h2><p class="mt-2">You've successfully simulated creating a Conditional Access policy.</p><button id="sim-ca-btn-reset" class="sim-btn-secondary px-4 py-2 rounded mt-6">Reset Simulation</button></div></div></div></div><div id="sim-ca-instruction-box" class="sim-instruction p-4 rounded-lg mt-4 max-w-4xl mx-auto"><p id="sim-ca-instruction-text" class="font-medium"></p></div></div>`;
        const createSimContentAutopilot = () => `<div class="tab-content hidden" data-tab-content="sim" data-week="7"><h4 class="text-xl font-semibold mb-4 text-center" style="color: var(--primary-color);">Sim Lab: Import Autopilot Device Hash</h4><div class="sim-container rounded-lg overflow-hidden max-w-4xl mx-auto"><div class="sim-header p-2 text-sm font-semibold">Microsoft Intune admin center</div><div class="flex h-[500px]"><div class="sim-sidebar w-1/4 p-2 space-y-1 text-sm"><div class="p-2 rounded cursor-pointer sim-menu-item" id="sim-ap-menu-home">Home</div><div class="p-2 rounded cursor-pointer sim-menu-item" id="sim-ap-menu-devices">Devices</div><div class="p-2 rounded cursor-pointer sim-menu-item" id="sim-ap-menu-enrollment"> &nbsp; &nbsp; ↳ Enrollment</div></div><div class="w-3/4 p-4 relative overflow-y-auto" id="sim-ap-main-content"><div id="sim-ap-blade-enroll" class="sim-blade p-4 hidden"><h2 class="text-lg font-bold mb-4">Device enrollment</h2><div id="sim-ap-link-autopilot" class="p-2 rounded cursor-pointer sim-link">Windows Autopilot</div></div><div id="sim-ap-blade-autopilot" class="sim-blade p-4 hidden"><h2 class="text-lg font-bold mb-4">Windows Autopilot devices</h2><button id="sim-ap-btn-import" class="sim-btn px-3 py-1 rounded text-sm">Import</button></div><div id="sim-ap-blade-import" class="sim-blade p-4 hidden"><h2 class="text-lg font-bold mb-4">Add Windows Autopilot devices</h2><p class="mb-4">Select a.csv file with the list of devices to add.</p><label for="sim-ap-file-upload" class="sim-btn-secondary px-4 py-2 rounded cursor-pointer">Select a file</label><input type="file" id="sim-ap-file-upload" class="hidden"><p id="sim-ap-file-name" class="mt-2 text-sm"></p><div class="mt-6 text-right"><button id="sim-ap-btn-import-final" class="sim-btn px-4 py-2 rounded" disabled>Import</button></div></div><div id="sim-ap-blade-success" class="text-center p-8 hidden"><div class="text-5xl mb-4">✅</div><h2 class="text-2xl font-bold" style="color: var(--success-text-color);">Import Complete!</h2><p class="mt-2">You've successfully simulated importing an Autopilot device hash.</p><button id="sim-ap-btn-reset" class="sim-btn-secondary px-4 py-2 rounded mt-6">Reset Simulation</button></div></div></div></div><div id="sim-ap-instruction-box" class="sim-instruction p-4 rounded-lg mt-4 max-w-4xl mx-auto"><p id="sim-ap-instruction-text" class="font-medium"></p></div></div>`;
        
        const renderWeekCards = () => {
            const list = document.getElementById('weeks-list');
            list.innerHTML = weeklyData.map(week => {
                const weekTasks = contentData[week.week]?.lab?.steps.map(s => s.id) || [];
                const completedTasks = weekTasks.filter(id => todoState[id]).length;
                const progress = weekTasks.length > 0 ? (completedTasks / weekTasks.length) * 100 : 0;

                return `
                <div class="sidebar-link p-3 rounded-lg cursor-pointer" data-week="${week.week}" data-part="${week.part}" data-title="${week.title}">
                    <div class="flex justify-between items-start">
                        <span class="text-sm font-semibold" style="color: var(--primary-color);">Week ${week.week}</span>
                        <span class="text-xs px-2 py-1 rounded-full" style="background-color: var(--highlight-bg-color); color: var(--text-muted-color);">Part ${week.part}</span>
                    </div>
                    <h3 class="text-md font-bold mt-1">${week.title}</h3>
                    <div class="w-full rounded-full h-1.5 mt-2" style="background-color: var(--highlight-bg-color);">
                        <div class="h-1.5 rounded-full transition-all duration-500" style="width: ${progress}%; background-color: var(--primary-color);"></div>
                    </div>
                </div>
            `}).join('');
            addWeekCardListeners();
        };

        const renderContent = (week, isInitial = false) => {
            const contentDisplay = document.getElementById('content-display');
            const weeklyInfo = weeklyData.find(w => w.week === week);
            const data = contentData[week];

            const content = createContentCard(week);
            
            if (isInitial) {
                contentDisplay.innerHTML = content;
            } else {
                contentDisplay.classList.add('content-fade-enter');
                setTimeout(() => {
                    contentDisplay.innerHTML = content;
                    contentDisplay.classList.add('content-fade-enter-active');
                }, 150);
                setTimeout(() => contentDisplay.classList.remove('content-fade-enter', 'content-fade-enter-active'), 300);
            }

            // Add all event listeners
            addTabListeners(); 
            addTodoListeners(); 
            addNotesListeners(); 
            addLabStepListeners(); 
            addShareButtonListeners();
            
            // Immediately apply saved todo states after rendering
            requestAnimationFrame(() => {
                loadTodoStateForWeek(week);
            });
            if (document.querySelector('[data-tab-content="sim"][data-week="2"]')) setupSimulationCA();
            if (document.querySelector('[data-tab-content="sim"][data-week="7"]')) setupSimulationAutopilot();
            loadTodoStateForWeek(week); loadNotesForWeek(week); checkWeekCompletion(week);
        };
        
        const selectWeek = (week) => {
            currentWeek = week;
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.toggle('active', parseInt(link.dataset.week) === week);
            });
            renderContent(week);
        };

        const addWeekCardListeners = () => {
            document.querySelectorAll('.sidebar-link[data-week]').forEach(card => {
                card.addEventListener('click', () => selectWeek(parseInt(card.dataset.week)));
            });
        };

        const addSidebarListeners = () => {
            document.querySelectorAll('.sidebar-link[data-filter]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.querySelectorAll('.sidebar-link[data-filter]').forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                    const filter = link.dataset.filter;
                    document.querySelectorAll('.sidebar-link[data-week]').forEach(card => {
                        card.style.display = (filter === 'all' || card.dataset.part === filter) ? '' : 'none';
                    });
                });
            });
        };

        const saveTodoState = () => localStorage.setItem('m365TodoState', JSON.stringify(todoState));
        const loadTodoState = () => { 
            todoState = JSON.parse(localStorage.getItem('m365TodoState')) || {}; 
            // Calculate total tasks across all weeks
            totalTasks = Object.values(contentData).reduce((total, weekData) => {
                return total + (weekData.lab?.steps?.length || 0);
            }, 0);
        };
        const updateTotalProgress = () => {
            const progressBar = document.getElementById('progressBar');
            const completedTasksEl = document.getElementById('completedTasks');
            const totalTasksEl = document.getElementById('totalTasks');
            
            if (progressBar && completedTasksEl && totalTasksEl) {
                const completedTasks = Object.values(todoState).filter(Boolean).length;
                const percentage = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
                
                // Update progress bar with animation
                progressBar.style.width = `${percentage}%`;
                progressBar.style.opacity = percentage > 0 ? '1' : '0.5';
                
                // Update task counts with animation
                completedTasksEl.textContent = completedTasks;
                totalTasksEl.textContent = totalTasks;
                
                // Add glow effect for 100% completion
                if (percentage === 100) {
                    progressBar.style.boxShadow = '0 0 20px var(--primary-color)';
                } else {
                    progressBar.style.boxShadow = '0 0 8px var(--primary-color)';
                }
            }
        };
        const checkWeekCompletion = (week) => {
            const weekTasks = contentData[week]?.lab?.steps.map(s => s.id) || [];
            const isComplete = weekTasks.length > 0 && weekTasks.every(id => todoState[id]);
            const shareButton = document.getElementById(`share-week-${week}`);
            const shareHelper = document.getElementById(`share-helper-week-${week}`);
            if (shareButton && shareHelper) {
                if (isComplete) {
                    shareButton.disabled = false;
                    shareHelper.classList.add('hidden');
                } else {
                    shareButton.disabled = true;
                    shareHelper.classList.remove('hidden');
                }
            }
        };
        const loadTodoStateForWeek = (week) => {
            const data = contentData[week];
            if (data && data.lab && data.lab.steps) {
                // First ensure todoState has entries for all steps
                data.lab.steps.forEach(step => {
                    if (todoState[step.id] === undefined) {
                        todoState[step.id] = false;
                    }
                });
                
                // Then update the UI for each step
                data.lab.steps.forEach(step => {
                    const cb = document.getElementById(step.id);
                    if (cb) {
                        const isChecked = !!todoState[step.id];
                        // Update checkbox state
                        cb.checked = isChecked;
                        
                        // Update parent container class for visual state
                        const todoItem = cb.closest('.todo-item');
                        if (todoItem) {
                            todoItem.classList.toggle('is-checked', isChecked);
                        }
                        
                        // Ensure the label is properly styled
                        const label = document.querySelector(`label[for="${step.id}"]`);
                        if (label) {
                            label.classList.toggle('checked', isChecked);
                        }
                    }
                });
                
                // Save state to ensure it's persistent
                saveTodoState();
                updateTotalProgress();
            }
        };
        const addTodoListeners = () => {
            document.getElementById('content-display').addEventListener('change', e => { 
                if (e.target.dataset.todoid) {
                    const isChecked = e.target.checked;
                    const todoItem = e.target.closest('.todo-item');
                    
                    if (todoItem) {
                        // Toggle is-checked class
                        todoItem.classList.toggle('is-checked', isChecked);
                        
                        // Update state
                        todoState[e.target.dataset.todoid] = isChecked; 
                        saveTodoState(); 
                        
                        // Update UI
                        updateTotalProgress(); 
                        checkWeekCompletion(currentWeek); 
                        renderWeekCards();
                        
                        // Re-highlight the current week after re-rendering
                        document.querySelectorAll('.sidebar-link').forEach(link => {
                            link.classList.toggle('active', parseInt(link.dataset.week) === currentWeek);
                        });

                        // Ensure checkbox state is preserved
                        e.target.checked = isChecked;
                    }
                } 
            });

            // Also handle label clicks for better UX
            document.getElementById('content-display').addEventListener('click', e => {
                const label = e.target.closest('label[for]');
                if (label) {
                    const checkbox = document.getElementById(label.getAttribute('for'));
                    if (checkbox && checkbox.dataset.todoid) {
                        checkbox.checked = !checkbox.checked;
                        checkbox.dispatchEvent(new Event('change', { bubbles: true }));
                    }
                }
            });
        };
        
        const addNotesListeners = () => {
            document.getElementById('content-display').addEventListener('input', e => { if(e.target.id.startsWith('notes-week-')) localStorage.setItem(e.target.id, e.target.value); });
        };
        const loadNotesForWeek = (week) => {
            const textarea = document.getElementById(`notes-week-${week}`);
            if(textarea) { textarea.value = localStorage.getItem(`notes-week-${week}`) || ''; }
        };
        const addSearchListener = () => {
            document.getElementById('search-input').addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                document.querySelectorAll('.sidebar-link[data-week]').forEach(card => {
                    const weekTitle = card.dataset.title.toLowerCase();
                    card.style.display = weekTitle.includes(searchTerm)? '' : 'none';
                });
            });
        };
        const addLabStepListeners = () => {
            document.getElementById('content-display').addEventListener('click', e => {
                // Only handle clicks on the expand button or the header (excluding checkbox and screenshot button)
                const expandBtn = e.target.closest('.expand-btn');
                const header = e.target.closest('.lab-step-header');
                
                if ((expandBtn || header) && !e.target.closest('input[type="checkbox"]') && !e.target.closest('.screenshot-btn')) {
                    e.preventDefault();
                    const labStep = (expandBtn || header).closest('.lab-step');
                    if (!labStep) return;
                    
                    const wasOpen = labStep.classList.contains('open');
                    const content = labStep.querySelector('.lab-step-content');
                    
                    // Close all other open steps first
                    document.querySelectorAll('.lab-step.open').forEach(step => {
                        if (step !== labStep) {
                            step.classList.remove('open');
                            const otherContent = step.querySelector('.lab-step-content');
                            if (otherContent) {
                                otherContent.style.maxHeight = '0';
                            }
                        }
                    });
                    
                    // Toggle the clicked step
                    requestAnimationFrame(() => {
                        if (!wasOpen) {
                            labStep.classList.add('open');
                            if (content) {
                                const height = content.scrollHeight;
                                content.style.maxHeight = height + 'px';
                            }
                        } else {
                            labStep.classList.remove('open');
                            if (content) {
                                content.style.maxHeight = '0';
                            }
                        }
                    });
                }
            });
        };
        const addShareButtonListeners = () => {
            document.getElementById('content-display').addEventListener('click', e => {
                const button = e.target.closest('.share-button');
                if (button) {
                    const week = button.id.replace('share-week-', '');
                    const postText = contentData[week].linkedinPost;
                    if (postText) {
                        // Create the LinkedIn share URL
                        const shareUrl = new URL('https://www.linkedin.com/posts/new/');
                        // Add the post text as a query parameter
                        shareUrl.searchParams.append('text', postText);
                        // Open in a new tab
                        window.open(shareUrl.toString(), '_blank');
                    }
                }
            });
        };

        const addTabListeners = () => {
            document.getElementById('content-display').addEventListener('click', e => {
                const button = e.target.closest('.tab-button');
                if (button) {
                    const week = button.dataset.week, tab = button.dataset.tab;
                    document.querySelectorAll(`#content-display .tab-button[data-week="${week}"]`).forEach(btn => { btn.classList.remove('active'); btn.style.borderColor = 'transparent'; btn.style.color = 'var(--text-muted-color)'; });
                    button.classList.add('active'); button.style.borderColor = 'var(--primary-color)'; button.style.color = 'var(--primary-color)';
                    document.querySelectorAll(`#content-display .tab-content[data-week="${week}"]`).forEach(c => c.classList.add('hidden'));
                    document.querySelector(`#content-display .tab-content[data-tab-content="${tab}"][data-week="${week}"]`).classList.remove('hidden');
                }
            });
        };

        const setupSimulationCA = () => { /* Logic for CA sim */ };
        const setupSimulationAutopilot = () => { /* Logic for Autopilot sim */ };
        
        // Timer functions
        const updateTimerDisplay = () => {
            const minutes = Math.floor(studyTimer.timeLeft / 60);
            const seconds = studyTimer.timeLeft % 60;
            const timerDisplay = document.getElementById('timer-display');
            const modeDisplay = document.getElementById('timer-mode');
            const toggleButton = document.getElementById('timer-toggle');
            
            // Update time
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update mode display
            if (modeDisplay) {
                modeDisplay.textContent = studyTimer.isBreak ? 'Break Time' : 'Focus Time';
                modeDisplay.style.backgroundColor = studyTimer.isBreak ? 'var(--success-bg-color)' : 'var(--accent-bg-color)';
                modeDisplay.style.color = studyTimer.isBreak ? 'var(--success-text-color)' : 'var(--primary-color)';
            }
            
            // Update button text
            if (toggleButton) {
                if (studyTimer.isRunning) {
                    toggleButton.textContent = 'Pause';
                    toggleButton.style.backgroundColor = studyTimer.isBreak ? 'var(--success-border-color)' : 'var(--primary-color)';
                } else {
                    toggleButton.textContent = studyTimer.isBreak ? 'Start Break' : 'Start Focus';
                    toggleButton.style.backgroundColor = studyTimer.isBreak ? 'var(--success-border-color)' : 'var(--primary-color)';
                }
            }
        };

        const startTimer = () => {
            if (!studyTimer.isRunning) {
                studyTimer.isRunning = true;
                document.getElementById('timer-toggle').textContent = 'Pause';
                studyTimer.interval = setInterval(() => {
                    studyTimer.timeLeft--;
                    updateTimerDisplay();
                    if (studyTimer.timeLeft <= 0) {
                        if (!studyTimer.isBreak) {
                            // Switch to break
                            studyTimer.isBreak = true;
                            studyTimer.timeLeft = studyTimer.breakTime;
                            new Notification('Study Timer', { 
                                body: 'Time for a break!',
                                icon: '/favicon.ico'
                            });
                        } else {
                            // Switch back to study
                            studyTimer.isBreak = false;
                            studyTimer.timeLeft = studyTimer.duration;
                            new Notification('Study Timer', { 
                                body: 'Break is over. Back to studying!',
                                icon: '/favicon.ico'
                            });
                        }
                        updateTimerDisplay();
                    }
                }, 1000);
            } else {
                pauseTimer();
            }
        };

        const pauseTimer = () => {
            studyTimer.isRunning = false;
            document.getElementById('timer-toggle').textContent = 'Start';
            clearInterval(studyTimer.interval);
        };

        const resetTimer = () => {
            pauseTimer();
            studyTimer.timeLeft = studyTimer.duration;
            studyTimer.isBreak = false;
            updateTimerDisplay();
        };

        // Achievement functions
        const checkAchievements = () => {
            // Check Week Master achievement
            Object.values(contentData).forEach((weekData, weekIndex) => {
                const weekNum = weekIndex + 1;
                const weekTasks = weekData.lab?.steps.map(s => s.id) || [];
                const isComplete = weekTasks.length > 0 && weekTasks.every(id => todoState[id]);
                if (isComplete) {
                    unlockAchievement('weekCompleter');
                }
            });

            // Check Perfect Student achievement
            const hasAllNotes = Object.values(contentData).every(weekData => {
                return localStorage.getItem(`notes-week-${weekData.week}`)?.trim().length > 0;
            });
            if (hasAllNotes) {
                unlockAchievement('perfectStudent');
            }

            // Update achievements display
            updateAchievementsDisplay();
        };

        const unlockAchievement = (achievementId) => {
            const unlockedAchievements = JSON.parse(localStorage.getItem('unlockedAchievements') || '[]');
            if (!unlockedAchievements.includes(achievementId)) {
                unlockedAchievements.push(achievementId);
                localStorage.setItem('unlockedAchievements', JSON.stringify(unlockedAchievements));
                new Notification('Achievement Unlocked!', {
                    body: `${achievements[achievementId].title}: ${achievements[achievementId].description}`,
                    icon: '/favicon.ico'
                });
                updateAchievementsDisplay();
            }
        };

        const updateAchievementsDisplay = () => {
            const achievementsList = document.getElementById('achievements-list');
            const unlockedAchievements = JSON.parse(localStorage.getItem('unlockedAchievements') || '[]');
            
            achievementsList.innerHTML = Object.entries(achievements).map(([id, achievement]) => `
                <div class="achievement flex items-center gap-2 p-2 rounded ${unlockedAchievements.includes(id) ? 'bg-green-100 dark:bg-green-900' : 'bg-gray-100 dark:bg-gray-800'}">
                    <span class="text-2xl">${achievement.icon}</span>
                    <div>
                        <div class="font-semibold">${achievement.title}</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">${achievement.description}</div>
                    </div>
                </div>
            `).join('');
        };

        document.addEventListener('DOMContentLoaded', () => {
            // Initialize todo state first
            loadTodoState();
            // Update total tasks count
            Object.values(contentData).forEach(weekData => {
                if (weekData.lab && weekData.lab.steps) {
                    weekData.lab.steps.forEach(step => {
                        if (todoState[step.id] === undefined) {
                            todoState[step.id] = false;
                        }
                    });
                }
            });
            saveTodoState();
            
            const darkModeToggle = document.getElementById('darkModeToggle'), body = document.documentElement, toggleDot = darkModeToggle.nextElementSibling.nextElementSibling;
            const applyTheme = (isDark) => { if (isDark) { body.classList.add('dark'); toggleDot.style.transform = 'translateX(100%)'; darkModeToggle.checked = true; } else { body.classList.remove('dark'); toggleDot.style.transform = 'translateX(0)'; darkModeToggle.checked = false; } };
            applyTheme(localStorage.getItem('theme') === 'dark');
            darkModeToggle.addEventListener('change', () => { const isDark = darkModeToggle.checked; applyTheme(isDark); localStorage.setItem('theme', isDark ? 'dark' : 'light'); });
            
            totalTasks = Object.values(contentData).reduce((acc, week) => acc + (week.lab ? week.lab.steps.length : 0), 0);
            loadTodoState();
            renderWeekCards();
            addSidebarListeners();
            addSearchListener();
            updateTotalProgress();
            selectWeek(1);
            
            document.body.addEventListener('click', e => {
                if (e.target.classList.contains('screenshot-btn')) {
                    const modal = document.getElementById('screenshotModal'), img = document.getElementById('screenshotImage'), title = document.getElementById('screenshotTitle');
                    e.stopPropagation(); 
                    img.src = e.target.dataset.src; 
                    title.textContent = e.target.dataset.title; 
                    modal.classList.remove('opacity-0', 'pointer-events-none'); 
                    modal.querySelector('.modal-content').classList.remove('scale-95');
                }
            });

            const closeScreenshotModal = () => {
                const modal = document.getElementById('screenshotModal');
                modal.classList.add('opacity-0', 'pointer-events-none'); 
                modal.querySelector('.modal-content').classList.add('scale-95');
            };
            document.getElementById('closeScreenshotModalBtn').addEventListener('click', closeScreenshotModal);
            document.getElementById('screenshotModal').addEventListener('click', e => { if (e.target === document.getElementById('screenshotModal')) closeScreenshotModal(); });
            
            const sidebar = document.getElementById('sidebar');
            const toggle = document.getElementById('sidebar-toggle');
            
            if (toggle) {
                toggle.addEventListener('click', () => {
                    sidebar.classList.toggle('collapsed');
                    localStorage.setItem('sidebarCollapsed', sidebar.classList.contains('collapsed'));
                });
            }

            if (localStorage.getItem('sidebarCollapsed') === 'true') {
                sidebar.classList.add('collapsed');
            }

            // Initialize timer controls
            document.getElementById('timer-toggle').addEventListener('click', startTimer);
            document.getElementById('timer-reset').addEventListener('click', resetTimer);
            updateTimerDisplay();

            // Request notification permission
            if ('Notification' in window) {
                Notification.requestPermission();
            }

            // Initialize achievements
            updateAchievementsDisplay();

            // Check achievements whenever todo state changes
            const originalSaveTodoState = saveTodoState;
            saveTodoState = () => {
                originalSaveTodoState();
                checkAchievements();
            };
        });
    </script>
</body>
</html>